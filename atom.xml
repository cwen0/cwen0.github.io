<?xml version="1.0" encoding="UTF-8"?><feed xmlns="http://www.w3.org/2005/Atom">
  <title>cwen&#39;s blog</title>
  <id>http://www.cwen.pw</id>
  <updated>2016-11-06T13:45:14+08:00</updated>
  <subtitle>æ²‰ç¨³ï¼Œä¸ä¹å¯çˆ±</subtitle>
  <link href="http://www.cwen.pw"></link>
  <entry>
    <title>ljgo - é™æ€åšå®¢å¼•æ“(0.1.0-betaç‰ˆ)</title>
    <updated>2016-09-08T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2016-09-08:/2016/ljgo - é™æ€åšå®¢å¼•æ“(0.1.0-betaç‰ˆ).html</id>
    <content type="html">&lt;p&gt;ljgo æ˜¯ä½¿ç”¨GO è¯­è¨€å®ç°çš„ç®€å•é™æ€åšå®¢å¼•æ“, ç¼–è¯‘é€Ÿåº¦å¿«ã€å®‰è£…ç®€å•ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;ç›®å‰ç‰ˆæœ¬ 0.1.0-beta&lt;/h4&gt;&#xA;&#xA;&lt;h2&gt;å®‰è£…&lt;/h2&gt;&#xA;&#xA;&lt;h4&gt;æºç å®‰è£…&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;goè¿è¡Œç¯å¢ƒå®‰è£…è¯·è‡ªè¡Œgoogle&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;go get -u github.com/cwen-coder/ljgo&#xA;make install&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;ä¸‹è½½åœ°å€ ï¼š &lt;a href=&#34;https://github.com/cwen-coder/ljgo/releases&#34;&gt;ljgo&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;å¿«é€Ÿå…¥é—¨&lt;/h2&gt;&#xA;&#xA;&lt;h4&gt;æ–°å»ºç«™ç‚¹&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ljgo new example.com&#xA;#æ‰§è¡Œå®Œæ¯•åï¼Œä¼šåœ¨ç”Ÿæˆexample.comæ–‡ä»¶å¤¹&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;example.com&lt;/code&gt; æ–‡ä»¶å¤¹ç›®å½•ç»“æ„&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;- config.yml    // ç«™ç‚¹é…ç½®æ–‡ä»¶&#xA;- source // ä¿å­˜æ–‡ç« ç›®å½•&#xA;- - | - - about.md // å…³äºé¡µé¢å†…å®¹&#xA;- - | - - article.md // æ¼”ç¤ºæ–‡ç« å†…å®¹&#xA;- themes  // ä¿å­˜æ‰€æœ‰ä¸»é¢˜&#xA;- - | - - default // ç«™ç‚¹é»˜è®¤ä¸»é¢˜&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;config.yml&lt;/code&gt; é…ç½®æ ¼å¼&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;site:&#xA;    title: ç½‘ç«™æ ‡é¢˜&#xA;    introduce: ç½‘ç«™æè¿°&#xA;    limit: æ¯é¡µå¯æ˜¾ç¤ºçš„æ–‡ç« æ•°ç›®&#xA;    theme: ç½‘ç«™ä¸»é¢˜ç›®å½•   ï¼ƒeg: themes/default&#xA;    url: ç«™ç‚¹åŸŸå&#xA;    comment: è¯„è®ºæ’ä»¶å˜é‡(é»˜è®¤ä¸ºDisqusè´¦æˆ·å)&#xA;    github: github.com åœ°å€ # å¯é€‰&#xA;    facebook: facebook åœ°å€  # å¯é€‰&#xA;    twitter: twitter åœ°å€  # å¯é€‰&#xA;serve:&#xA;    addr: ljgo serve ç›‘å¬åœ°å€ # eg: &amp;quot;localhost:3000&amp;quot;&#xA;&#xA;publish:&#xA;    cmd: |&#xA;        ljgo publish å‘½ä»¤å°†ä¼šæ‰§è¡Œçš„è„šæœ¬&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;åˆ›å»ºæ–‡ç« &lt;/p&gt;&#xA;&#xA;&lt;p&gt;åœ¨sourceç›®å½•ä¸­å»ºç«‹ä»»æ„.mdæ–‡ä»¶ï¼ˆå¯ç½®äºå­æ–‡ä»¶å¤¹ï¼‰ï¼Œä½¿ç”¨å¦‚ä¸‹æ ¼å¼ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;title: æ–‡ç« æ ‡é¢˜&#xA;author: æ–‡ç« ä½œè€…&#xA;date: 2016-08-02&#xA;update: 2016-08-02&#xA;tags:&#xA;    - è®¾è®¡&#xA;    - å†™ä½œ&#xA;&#xA;---&#xA;&#xA;æ–‡ç« é¢„è§ˆå†…å®¹&#xA;    &amp;lt;!--more--&amp;gt;&#xA;æ–‡ç« å…¶å®ƒå†…å®¹&#xA;(æ–‡ç« çš„å…¨éƒ¨å†…å®¹ï¼é¢„è§ˆï¼‹å…¶ä»–)&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;ç”Ÿæˆé™æ€é¡µé¢&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ljgo build&#xA;# æ‰§è¡Œå®Œæ¯•åœ¨ç«™ç‚¹æ–‡ä»¶ä¸‹ç”Ÿæˆpublicæ–‡ä»¶å¤¹ï¼ŒåŒ…å«æ‰€æœ‰é™æ€æ–‡ä»¶&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;dl&gt;&#xA;&lt;dt&gt;åœ¨ç«™ç‚¹æ–‡ä»¶å¤¹ä¸­ç›´æ¥æ‰§è¡Œ &lt;code&gt;ljgo build&lt;/code&gt; ï¼Œ æˆ–æ˜¯åœ¨ç«™ç‚¹æ–‡ä»¶å¤¹å¤–æ‰§è¡Œä½†æ˜¯å¾—æŒ‡å®šç«™ç‚¹è·¯å¾„ eg&lt;/dt&gt;&#xA;&lt;dd&gt;&lt;code&gt;ljgo build example.com&lt;/code&gt;&#xA;&lt;code&gt;ljgo serve&lt;/code&gt; &lt;code&gt;ljgo publis&lt;/code&gt; éƒ½æ˜¯åŒæ ·çš„ä½¿ç”¨å§¿åŠ¿&lt;/dd&gt;&#xA;&lt;/dl&gt;&#xA;&#xA;&lt;h4&gt;æœ¬åœ°é¢„è§ˆ&lt;/h4&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ligo serve&#xA;# æ‰“æ¥æµè§ˆå™¨, è®¿é—®ä½ åœ¨ç«™ç‚¹é…ç½®ä¸­å¡«å…¥çš„ç«¯å£åœ°å€&#xA;# é»˜è®¤æ˜¯ http://localhost:3000&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥å°† &lt;code&gt;ljgo serve&lt;/code&gt; è¿è¡Œåœ¨ &lt;code&gt;vps&lt;/code&gt; ä¸Š&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;éƒ¨ç½²&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://pages.github.com/&#34;&gt;github pages&lt;/a&gt; ç­‰æœåŠ¡ï¼Œæˆ–è€…æ”¾åˆ°ä½ çš„è‡ªå·±çš„vpsä¸‹ï¼Œå› ä¸ºæ˜¯çº¯é™æ€æ–‡ä»¶,ä¸éœ€è¦php/mysql/javaç­‰ç¯å¢ƒçš„æ”¯æŒ&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ljgo publish&#xA;# æ‰§è¡Œç«™ç‚¹é…ç½®ä¸­å¡«å†™çš„å‘å¸ƒè„šæœ¬&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;eg : ä½¿ç”¨ &lt;code&gt;github&lt;/code&gt;æœåŠ¡ï¼Œ åˆå§‹åŒ–å¥½ &lt;code&gt;public&lt;/code&gt;  æ–‡ä»¶å¤¹åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ &lt;code&gt;config.yml&lt;/code&gt; æ–‡ä»¶ä¸­çš„å¡«å†™å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;publish:&#xA;    cmd: |&#xA;        git add -A&#xA;        git commit -m &amp;quot;update&amp;quot;&#xA;        git push origin&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;è¿™æ ·æˆ‘ä»¬åœ¨æ¯æ¬¡ç¼–è¾‘å®Œåšå®¢åç›´æ¥è¿è¡Œ &lt;code&gt;ljgo publish&lt;/code&gt; å°±ä¸€åˆ‡ok&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;å…³äºä¸»é¢˜&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;ç”±äºè‡ªå·±æ¯”è¾ƒæ‡’ï¼Œç›®å‰çš„é»˜è®¤ä¸»é¢˜æ˜¯ä» &lt;a href=&#34;https://startbootstrap.com&#34;&gt;start bootstrapt&lt;/a&gt; ä¸­çš„ &lt;a href=&#34;https://startbootstrap.com/template-overviews/clean-blog/&#34;&gt;clean-blog&lt;/a&gt; ä¿®æ”¹è€Œæ¥&#xA;å½“å¯¼å…¥å…¶ä»–ä¸»é¢˜ï¼Œéœ€è¦æŠŠä¸»é¢˜æ–‡ä»¶å¤¹å¤åˆ¶åˆ° &lt;code&gt;example.com/themes/&lt;/code&gt; æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¿®æ”¹ç«™ç‚¹é…ç½® &lt;code&gt;config.yml&lt;/code&gt; ä¸­ä¸»é¢˜è·¯å¾„&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;ååˆ†æ¬¢è¿å¤§å®¶è´¡çŒ®ç¬¬ä¸‰æ–¹ä¸»é¢˜ ğŸ‘&lt;/h4&gt;&#xA;&#xA;&lt;h2&gt;æ­£åœ¨ä½¿ç”¨&lt;/h2&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;http://www.cwen.pw&#34;&gt;cwen&amp;rsquo;s blog&lt;/a&gt;           - me&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;æœŸå¾…æ›´å¤šçš„ç”¨æˆ·&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;åé¦ˆè´¡çŒ®&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;éå¸¸æ¬¢è¿ä»»ä½•äººçš„ä»»ä½•è´¡çŒ®ã€‚å¦‚æœ‰é—®é¢˜å¯æŠ¥å‘Šè‡³ &lt;a href=&#34;https://github.com/cwen-coder/ljgo/issues&#34;&gt;https://github.com/cwen-coder/ljgo/issues&lt;/a&gt;ã€‚&#xA;æˆ–æ˜¯ç›´æ¥å‘é‚®ä»¶To me &lt;a href=&#34;mailto:yincwengo@gmail.com&#34;&gt;yincwengo@gmail.com&lt;/a&gt;&lt;/p&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2016/ljgo - é™æ€åšå®¢å¼•æ“(0.1.0-betaç‰ˆ).html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>goç¬”è®°-å…³äºGC</title>
    <updated>2016-08-20T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2016-08-20:/2016/goç¬”è®°-å…³äºGC.html</id>
    <content type="html">&lt;p&gt;GO â€œéåˆ†ä»£çš„ã€éç´§ç¼©ã€å†™å±éšœã€å¹¶å‘æ ‡è®°æ¸…ç†â€&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;å¹¶å‘æ¸…ç†ï¼š åƒåœ¾å›æ”¶(æ¸…ç†è¿‡ç¨‹)ä¸ç”¨æˆ·é€»è¾‘å¹¶å‘æ‰§è¡Œ&#xA;  ä¸‰è‰²å¹¶å‘æ ‡è®° :  æ ‡è®°ä¸ç”¨æˆ·é€»è¾‘å¹¶å‘æ‰§è¡Œ&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;h2&gt;ä¸€èˆ¬å¸¸ç”¨åƒåœ¾å›æ”¶æ–¹æ³•&lt;/h2&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;å¼•ç”¨è®¡æ•°&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§åƒåœ¾å›æ”¶ç®—æ³•ï¼Œå’Œä¹‹å‰æåˆ°çš„æ™ºèƒ½æŒ‡é’ˆå¼‚æ›²åŒå·¥ã€‚å¯¹æ¯ä¸ªå¯¹è±¡ç»´æŠ¤ä¸€ä¸ª å¼•ç”¨è®¡æ•° ï¼Œå½“å¼•ç”¨è¯¥å¯¹è±¡çš„å¯¹è±¡è¢«é”€æ¯æˆ–æ›´æ–°æ—¶è¢«å¼•ç”¨å¯¹è±¡çš„å¼•ç”¨è®¡æ•°è‡ªåŠ¨å‡ä¸€ï¼Œå½“è¢«å¼•ç”¨å¯¹è±¡è¢«åˆ›å»ºæˆ–è¢«èµ‹å€¼ç»™å…¶ä»–å¯¹è±¡æ—¶å¼•ç”¨è®¡æ•°è‡ªåŠ¨åŠ ä¸€ã€‚å½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶åˆ™ç«‹å³å›æ”¶å¯¹è±¡ã€‚&#xA;  #### ä¼˜ç‚¹&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;æ˜¯å®ç°ç®€å•ï¼Œå¹¶ä¸”å†…å­˜çš„å›æ”¶å¾ˆåŠæ—¶ã€‚&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;#### ç¼ºç‚¹&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;é¢‘ç¹æ›´æ–°å¼•ç”¨è®¡æ•°é™ä½äº†æ€§èƒ½&#xA;å¾ªç¯å¼•ç”¨é—®é¢˜&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;æ ‡è®°-æ¸…é™¤&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;è¯¥æ–¹æ³•åˆ†ä¸ºä¸¤æ­¥ï¼Œ æ ‡è®° ä»æ ¹å˜é‡å¼€å§‹è¿­ä»£å¾—éå†æ‰€æœ‰è¢«å¼•ç”¨çš„å¯¹è±¡ï¼Œå¯¹èƒ½å¤Ÿé€šè¿‡åº”ç”¨éå†è®¿é—®åˆ°çš„å¯¹è±¡éƒ½è¿›è¡Œæ ‡è®°ä¸ºâ€œè¢«å¼•ç”¨â€ï¼›æ ‡è®°å®Œæˆåè¿›è¡Œ æ¸…é™¤ æ“ä½œï¼Œå¯¹æ²¡æœ‰æ ‡è®°è¿‡çš„å†…å­˜è¿›è¡Œå›æ”¶ï¼ˆå›æ”¶åŒæ—¶å¯èƒ½ä¼´æœ‰ç¢ç‰‡æ•´ç†æ“ä½œï¼‰ã€‚è¿™ç§æ–¹æ³•è§£å†³äº†å¼•ç”¨è®¡æ•°çš„ä¸è¶³ï¼Œä½†æ˜¯ä¹Ÿæœ‰æ¯”è¾ƒæ˜æ˜¾çš„é—®é¢˜ï¼šæ¯æ¬¡å¯åŠ¨åƒåœ¾å›æ”¶éƒ½ä¼šæš‚åœå½“å‰æ‰€æœ‰çš„æ­£å¸¸ä»£ç æ‰§è¡Œï¼Œå›æ”¶æ˜¯ç³»ç»Ÿå“åº”èƒ½åŠ›å¤§å¤§é™ä½ï¼å½“ç„¶åç»­ä¹Ÿå‡ºç°äº†å¾ˆå¤šmark&amp;amp;sweepç®—æ³•çš„å˜ç§ï¼ˆå¦‚ ä¸‰è‰²æ ‡è®°æ³• ï¼‰ä¼˜åŒ–äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;åˆ†ä»£æ”¶é›†&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;ç»è¿‡å¤§é‡å®é™…è§‚å¯Ÿå¾—çŸ¥ï¼Œåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œç»å¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½éå¸¸çŸ­ã€‚åˆ†ä»£æ”¶é›†çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå°†å †åˆ’åˆ†ä¸ºä¸¤ä¸ªæˆ–å¤šä¸ªç§°ä¸º ä»£ï¼ˆgenerationï¼‰ çš„ç©ºé—´ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡å­˜æ”¾åœ¨ç§°ä¸º æ–°ç”Ÿä»£ï¼ˆyoung generationï¼‰ ä¸­ï¼ˆä¸€èˆ¬æ¥è¯´ï¼Œæ–°ç”Ÿä»£çš„å¤§å°ä¼šæ¯” è€å¹´ä»£ å°å¾ˆå¤šï¼‰ï¼Œéšç€åƒåœ¾å›æ”¶çš„é‡å¤æ‰§è¡Œï¼Œç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ä¼šè¢« æå‡ï¼ˆpromotionï¼‰ åˆ°è€å¹´ä»£ä¸­ã€‚å› æ­¤ï¼Œæ–°ç”Ÿä»£åƒåœ¾å›æ”¶å’Œè€å¹´ä»£åƒåœ¾å›æ”¶ä¸¤ç§ä¸åŒçš„åƒåœ¾å›æ”¶æ–¹å¼åº”è¿è€Œç”Ÿï¼Œåˆ†åˆ«ç”¨äºå¯¹å„è‡ªç©ºé—´ä¸­çš„å¯¹è±¡æ‰§è¡Œåƒåœ¾å›æ”¶ã€‚æ–°ç”Ÿä»£åƒåœ¾å›æ”¶çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ¯”è€å¹´ä»£å¿«å‡ ä¸ªæ•°é‡çº§ï¼Œå³ä½¿æ–°ç”Ÿä»£åƒåœ¾å›æ”¶çš„é¢‘ç‡æ›´é«˜ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿä»ç„¶æ¯”è€å¹´ä»£åƒåœ¾å›æ”¶å¼ºï¼Œè¿™æ˜¯å› ä¸ºå¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¾ˆçŸ­ï¼Œæ ¹æœ¬æ— éœ€æå‡åˆ°è€å¹´ä»£ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;ä¸‰è‰²å¹¶å‘æ ‡è®° (1.5ä¹‹åä½¿ç”¨GCæ–¹æ³•)&lt;/h2&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In a tri-color collector, every object is either white, grey, or black and we view the heap as a graph of connected objects. At the start of a GC cycle all objects are white. The GC visits all roots, which are objects directly accessible by the application such as globals and things on the stack, and colors these grey. The GC then chooses a grey object, blackens it, and then scans it for pointers to other objects. When this scan finds a pointer to a white object, it turns that object grey. This process repeats until there are no more grey objects. At this point, white objects are known to be unreachable and can be reused.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;è¿™æ˜¯è®©æ ‡è®°ä¸ç”¨æˆ·ä»£ç å¹¶å‘çš„åŸºæœ¬ä¿éšœï¼Œ åŸºæœ¬åŸç†ï¼š&#xA;* èµ·åˆæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰²&#xA;* æ‰«ææ‰€æœ‰å¯è¾¾å¯¹è±¡ï¼Œæ ‡è®°ä¸ºç°è‰²ï¼Œæ”¾å…¥å¾…å¤„ç†é˜Ÿåˆ—&#xA;* ä»é˜Ÿåˆ—æå–ç°è‰²å¯¹è±¡ï¼Œå°†å…¶å¼•ç”¨å¯¹è±¡æ ‡è®°ä¸ºç°è‰²æ”¾å…¥é˜Ÿåˆ—ï¼Œè‡ªèº«æ ‡è®°ä¸ºé»‘è‰²&#xA;* å†™å±éšœç›‘æ§å¯¹è±¡å†…å­˜ä¿®æ”¹ï¼Œä»æ–°æ ‡è‰²æˆ–æ˜¯æ”¾å…¥é˜Ÿåˆ—&lt;/p&gt;&#xA;&#xA;&lt;p&gt;å½“å®Œæˆæ‰€æœ‰çš„æ‰«æå’Œæ ‡è®°çš„å·¥ä½œåï¼Œå‰©ä½™ä¸æ˜¯ç™½è‰²å°±æ˜¯é»‘è‰²ï¼Œåˆ†åˆ«ä»£è¡¨è¦å›æ”¶å’Œæ´»è·ƒå¯¹è±¡ï¼Œæ¸…ç†æ“ä½œåªéœ€è¦æŠŠç™½è‰²å¯¹è±¡å›æ”¶å†…å­˜å›æ”¶å°±å¥½&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&#34;http://7xnp02.com1.z0.glb.clouddn.com/Animation_of_tri-color_garbage_collection.gif&#34; alt=&#34;ä¸‰è‰²å¹¶å‘æ ‡è®°&#34; /&gt;&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;å¢é‡&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;ä¸‰è‰²æ ‡è®°çš„ç›®çš„ï¼Œä¸»è¦æ˜¯ç”¨äºåšå¢é‡çš„åƒåœ¾å›æ”¶ã€‚æ³¨æ„åˆ°ï¼Œå¦‚æœåªæœ‰é»‘è‰²å’Œç™½è‰²ä¸¤ç§é¢œè‰²ï¼Œé‚£ä¹ˆå›æ”¶è¿‡ç¨‹å°†ä¸èƒ½ä¸­æ–­ï¼Œå¿…é¡»ä¸€æ¬¡æ€§å®Œæˆï¼ŒæœŸé—´ç”¨æˆ·ç¨‹åºæ˜¯ä¸èƒ½è¿è¡Œçš„ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;è€Œä½¿ç”¨ä¸‰è‰²æ ‡è®°ï¼Œå³ä½¿åœ¨æ ‡è®°è¿‡ç¨‹ä¸­å¯¹è±¡çš„å¼•ç”¨å…³ç³»å‘ç”Ÿäº†æ”¹å˜ï¼Œä¾‹å¦‚åˆ†é…å†…å­˜å¹¶ä¿®æ”¹å¯¹è±¡å±æ€§åŸŸçš„å€¼ï¼Œåªè¦æ»¡è¶³é»‘è‰²å¯¹è±¡ä¸å¼•ç”¨ç™½è‰²å¯¹è±¡çš„çº¦æŸæ¡ä»¶ï¼Œåƒåœ¾å›æ”¶å™¨å°±å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œã€‚äºæ˜¯æ¯æ¬¡å¹¶ä¸éœ€è¦å°†å›æ”¶è¿‡ç¨‹å…¨éƒ¨æ‰§è¡Œå®Œï¼Œåªæ˜¯å¤„ç†ä¸€éƒ¨åˆ†ååœä¸‹æ¥ï¼Œåç»­ä¼šæ…¢æ…¢å†æ¬¡è§¦å‘çš„å›æ”¶è¿‡ç¨‹ï¼Œå®ç°å¢é‡å›æ”¶ã€‚ç›¸å½“äºæ˜¯æŠŠåƒåœ¾å›æ”¶è¿‡ç¨‹æ‰“æ•£ï¼Œå‡å°‘åœé¡¿æ—¶é—´ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;å†™å±éšœ (write barrier)&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;å¦‚æœæ˜¯STWçš„ï¼Œä¸‰è‰²æ ‡è®°æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯å¦‚æœå…è®¸ç”¨æˆ·ä»£ç è·Ÿåƒåœ¾å›æ”¶åŒæ—¶è¿è¡Œï¼Œéœ€è¦ç»´æŠ¤ä¸€æ¡çº¦æŸæ¡ä»¶ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;é»‘è‰²å¯¹è±¡ç»å¯¹ä¸èƒ½å¼•ç”¨ç™½è‰²å¯¹è±¡&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ä¸ºä»€ä¹ˆä¸èƒ½è®©é»‘è‰²å¼•ç”¨ç™½è‰²ï¼Ÿå› ä¸ºé»‘è‰²å¯¹è±¡æ˜¯æ´»è·ƒå¯¹è±¡ï¼Œå®ƒå¼•ç”¨çš„å¯¹è±¡æ˜¯ä¹Ÿåº”è¯¥å±äºæ´»è·ƒçš„ï¼Œä¸åº”è¯¥è¢«æ¸…ç†ã€‚ä½†æ˜¯ï¼Œç”±äºåœ¨ä¸‰è‰²æ ‡è®°ç®—æ³•ä¸­ï¼Œé»‘è‰²å¯¹è±¡å·²ç»å¤„ç†å®Œæ¯•ï¼Œå®ƒä¸ä¼šè¢«é‡å¤æ‰«æã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªå¯¹è±¡å¼•ç”¨çš„ç™½è‰²å¯¹è±¡å°†æ²¡æœ‰æœºä¼šè¢«ç€è‰²ï¼Œæœ€ç»ˆä¼šè¢«è¯¯å½“ä½œåƒåœ¾æ¸…ç†ã€‚&#xA;STWä¸­ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œåªæœ‰å®ƒå¼•ç”¨çš„å¯¹è±¡å…¨æ ‡è®°åæ‰ä¼šæ ‡è®°ä¸ºé»‘è‰²ã€‚æ‰€ä»¥é»‘è‰²å¯¹è±¡è¦ä¹ˆå¼•ç”¨çš„é»‘è‰²å¯¹è±¡ï¼Œè¦ä¹ˆå¼•ç”¨çš„ç°è‰²å¯¹è±¡ã€‚ä¸ä¼šå‡ºç°é»‘è‰²å¼•ç”¨ç™½è‰²å¯¹è±¡ã€‚&#xA;å¯¹äºåƒåœ¾å›æ”¶å’Œç”¨æˆ·ä»£ç å¹¶è¡Œçš„åœºæ™¯ï¼Œç”¨æˆ·ä»£ç å¯èƒ½ä¼šä¿®æ”¹å·²ç»æ ‡è®°ä¸ºé»‘è‰²çš„å¯¹è±¡ï¼Œè®©å®ƒå¼•ç”¨ç™½è‰²å¯¹è±¡ã€‚çœ‹ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;stack -&amp;gt; A.ref -&amp;gt; B&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Aæ˜¯ä»æ ˆå¯¹è±¡ç›´æ¥å¯è¾¾ï¼Œå°†å®ƒæ ‡è®°ä¸ºç°è‰²ã€‚æ­¤æ—¶Bæ˜¯ç™½è‰²å¯¹è±¡ã€‚å‡è®¾è¿™ä¸ªæ—¶å€™ç”¨æˆ·ä»£ç æ‰§è¡Œï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;localRef = A.ref&#xA;A.ref = NULL&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;localRefæ˜¯æ ˆä¸Šé¢çš„ä¸€ä¸ªé»‘è‰²å¯¹è±¡ï¼Œå‰ä¸€è¡Œèµ‹å€¼è¯­å¥ä½¿å¾—å®ƒå¼•ç”¨åˆ°Bå¯¹è±¡ã€‚åä¸€è¡ŒA.refè¢«ç½®ä¸ºç©ºä¹‹åï¼ŒAå°†ä¸å†å¼•ç”¨åˆ°Bã€‚Aæ˜¯ç°è‰²ä½†æ˜¯ä¸å†å¼•ç”¨åˆ°Bäº†ï¼ŒBä¸ä¼šç€è‰²ã€‚localRefæ˜¯é»‘è‰²ï¼Œå¤„ç†å®Œæ¯•çš„å¯¹è±¡ï¼Œå¼•ç”¨äº†Bä½†æ˜¯ä¸ä¼šè¢«å†æ¬¡å¤„ç†ã€‚äºæ˜¯Bå°†æ°¸è¿œä¸å†æœ‰æœºä¼šè¢«æ ‡è®°ï¼Œå®ƒä¼šè¢«è¯¯å½“ä½œåƒåœ¾æ¸…ç†æ‰ï¼&lt;/p&gt;&#xA;&#xA;&lt;p&gt;å¦‚æœå®ç°æ»¡è¶³è¿™ç§çº¦æŸæ¡ä»¶å‘¢ï¼Ÿwrite barrier!&#xA;æ¥è‡ªwikiçš„å¯¹è¿™ä¸ªæœ¯è¯­çš„è§£é‡Šï¼š&amp;rdquo;A write barrier in a garbage collector is a fragment of code emitted by the compiler immediately before every store operation to ensure that (e.g.) generational invariants are maintained.&amp;rdquo; å³æ˜¯è¯´ï¼Œåœ¨æ¯ä¸€å¤„å†…å­˜å†™æ“ä½œçš„å‰é¢ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆçš„ä¸€å°æ®µä»£ç æ®µï¼Œæ¥ç¡®ä¿ä¸è¦æ‰“ç ´ä¸€äº›çº¦æŸæ¡ä»¶ã€‚&#xA;å¢é‡å’Œåˆ†ä»£ï¼Œéƒ½éœ€è¦ç»´æŠ¤ä¸€ä¸ªwrite barrierã€‚&#xA;å…ˆçœ‹åˆ†ä»£çš„åƒåœ¾å›æ”¶ï¼Œè·¨è¶Šä¸åŒåˆ†ä»£ä¹‹é—´çš„å¼•ç”¨ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤§å¤šæ•°çš„äº¤å‰å¼•ç”¨åº”è¯¥æ˜¯ç”±æ–°ç”Ÿä»£å¯¹è±¡å¼•ç”¨è€ç”Ÿä»£å¯¹è±¡ã€‚å½“æˆ‘ä»¬å›æ”¶æ–°ç”Ÿä»£çš„æ—¶å€™ï¼Œè¿™æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯å½“æˆ‘ä»¬å›æ”¶è€ç”Ÿä»£çš„æ—¶å€™ï¼Œå¦‚æœåªæ‰«æè€ç”Ÿä»£ä¸æ‰«ææ–°ç”Ÿä»£ï¼Œåˆ™è€ç”Ÿä»£ä¸­çš„ä¸€äº›å¯¹è±¡å¯èƒ½è¢«è¯¯å½“ä½œä¸å¯è¾¾å¯¹è±¡å›æ”¶æ‰ï¼ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œå¯ä»¥åšä¸€ä¸ªçº¦å®š&amp;ndash;å¦‚æœå›æ”¶è€ç”Ÿä»£ï¼Œé‚£ä¹ˆæ¯”å®ƒå¹´è½»çš„æ–°ç”Ÿä»£éƒ½è¦ä¸€èµ·å›æ”¶ä¸€éã€‚å¦å¤–ä¸€ç§äº¤å‰å¼•ç”¨æ˜¯è€ç”Ÿä»£å¯¹è±¡å¼•ç”¨åˆ°æ–°ç”Ÿä»£å¯¹è±¡ï¼Œè¿™æ—¶å°±éœ€è¦write barrieräº†ï¼Œæ‰€æœ‰çš„è¿™ç§ç±»å‹å¼•ç”¨éƒ½åº”è¯¥è®°å½•ä¸‹æ¥ï¼Œæ”¾åˆ°ä¸€ä¸ªé›†åˆä¸­ï¼Œæ ‡è®°çš„æ—¶å€™è¦å¤„ç†è¿™ä¸ªé›†åˆã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;å†çœ‹ä¸‰è‰²æ ‡è®°ä¸­ï¼Œé»‘è‰²å¯¹è±¡ä¸èƒ½å¼•ç”¨ç™½è‰²å¯¹è±¡ã€‚è¿™å°±æ˜¯ä¸€ä¸ªçº¦æŸæ¡ä»¶ï¼Œwrite barrierå°±æ˜¯è¦ç»´æŠ¤è¿™æ¡çº¦æŸã€‚&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;go1.5  GC å®ç°è¿‡ç¨‹&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&#34;http://7xnp02.com1.z0.glb.clouddn.com/gc.png&#34; alt=&#34;gc è¿‡ç¨‹&#34; /&gt;&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;Go1.5åƒåœ¾å›æ”¶çš„å®ç°è¢«åˆ’åˆ†ä¸ºäº”ä¸ªé˜¶æ®µï¼š&lt;/h4&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;GCoff åƒåœ¾å›æ”¶å…³é—­çŠ¶æ€&lt;/li&gt;&#xA;&lt;li&gt;GCscan æ‰«æé˜¶æ®µ&lt;/li&gt;&#xA;&lt;li&gt;GCmark æ ‡è®°é˜¶æ®µï¼Œwrite barrierç”Ÿæ•ˆ&lt;/li&gt;&#xA;&lt;li&gt;GCmarktermination æ ‡è®°ç»“æŸé˜¶æ®µï¼ŒSTWï¼Œåˆ†é…é»‘è‰²å¯¹è±¡&lt;/li&gt;&#xA;&lt;li&gt;GCsweep æ¸…æ‰«é˜¶æ®µ&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&#34;http://7xnp02.com1.z0.glb.clouddn.com/gogc.png&#34; alt=&#34;gc  è¿‡ç¨‹&#34; /&gt;&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;æ§åˆ¶å™¨&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;å…¨ç¨‹å‚ä¸å¹¶å‘å›æ”¶ä»»åŠ¡ï¼Œ è®°å½•ç›¸å…³çŠ¶æ€æ•°æ®ï¼Œ åŠ¨æ€è°ƒæ•´è¿è¡Œç­–ç•¥ï¼Œå½±å“å¹¶å‘æ ‡è®°å·¥ä½œå•å…ƒçš„å·¥ä½œæ¨¡å¼å’Œæ•°é‡ï¼Œ å¹³è¡¡CPUèµ„æºå ç”¨ã€‚å½“å›æ”¶ç»“æŸæ—¶ï¼Œå‚ä¸next_gc å›æ”¶é˜€å€¼è®¾ç½®ï¼Œè°ƒæ•´åƒåœ¾å›æ”¶è§¦å‘é¢‘ç‡&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;è¿‡ç¨‹&lt;/h4&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;åˆå§‹åŒ–&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;è®¾ç½® &lt;code&gt;gcprecent(GOGC)&lt;/code&gt; å’Œ &lt;code&gt;next_gc&lt;/code&gt; é˜€å€¼&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;å¯åŠ¨&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;åœ¨ä¸ºå¯¹è±¡åˆ†é…å †å†…å­˜åï¼Œ&lt;code&gt;mallocgo&lt;/code&gt; å‡½æ•°ä¼šæ£€æŸ¥åƒåœ¾å›æ”¶è§¦å‘æ¡ä»¶ï¼Œå¹¶ä¾ç…§ç›¸å…³çŠ¶æ€å¯åŠ¨æˆ–å‚ä¸è¾…åŠ©å›æ”¶&#xA;åƒåœ¾å›æ”¶é»˜è®¤ä»¥å…¨å¹¶å‘ï¼Œä½†å¯ç”¨ç¯å¢ƒå˜é‡æˆ–äº‹å‚æ•°ç¦ç”¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…ç†ï¼Œgc goroutine ä¸€ç›´å¾ªç¯ï¼Œç›´åˆ°ç¬¦åˆè§¦å‘æ¡ä»¶æ—¶è¢«å”¤é†’&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;æ ‡è®°&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;åˆ†ä¿©æ­¥éª¤&#xA;&amp;gt; æ‰«æ ï¼šéå†ç›¸å…³å†…å­˜åŒºåŸŸï¼Œä¾ç…§æŒ‡é’ˆæ ‡è®°æ‰¾å‡ºç°è‰²å¯è¾¾å¯¹è±¡ï¼ŒåŠ å…¥é˜Ÿåˆ— ã€‚æ‰«æå‡½æ•° (gcscan_m) å¯åŠ¨æ—¶ï¼Œç”¨æˆ·ä»£ç å’Œæ ‡è®°å‡½æ•° (MarkWorker) éƒ½åœ¨è¿è¡Œ&#xA;&amp;gt; æ ‡è®° ï¼š å°†ç°è‰²å¯¹è±¡ä»é˜Ÿåˆ—ä¸­å–å‡ºï¼Œå°†å…¶åº”ç”¨å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼Œè‡ªèº«æ ‡è®°ä¸ºé»‘è‰²ã€‚ å¹¶å‘æ ‡è®°ç”±å¤šä¸ªMarkWorker goroutine å…±åŒå®Œæˆï¼Œå®ƒä»¬åœ¨å›æ”¶ä»»åŠ¡å®Œæˆå‰ç»‘å®šåˆ° P ï¼Œ ç„¶åè¿›å…¥ä¼‘çœ çŠ¶æ€ï¼ŒçŸ¥é“è¢«è°ƒåº¦å™¨å”¤é†’&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;æ¸…ç†&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;æ¸…ç†æœªè¢«æ ‡è®°çš„ç™½è‰²å¯¹è±¡ ï¼Œå°†å…¶å†…å­˜å›æ”¶&lt;/p&gt;&#xA;&#xA;&lt;p&gt;å¹¶å‘æ¸…ç†æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼Œè¢«å”¤é†’åå¼€å§‹æ‰§è¡Œæ¸…ç†ä»»åŠ¡ã€‚ é€šè¿‡éå†æ‰€æœ‰span å¯¹è±¡ï¼Œè§¦å‘å†…å­˜å›æ”¶å™¨çš„å›æ”¶æ“ä½œã€‚ä»»åŠ¡å®Œæˆåï¼Œå†æ¬¡ä¼‘çœ ï¼Œç­‰å¾…ä¸‹æ¬¡ä»»åŠ¡&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ç›‘æ§&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;æ¨¡æ‹Ÿæƒ…æ™¯ï¼šæœåŠ¡é‡å¯ï¼Œæµ·é‡æœåŠ¡é‡æ–°æ¥å…¥ï¼Œç¬é—´åˆ†é…å¤§é‡å¯¹è±¡ï¼Œå°†åƒåœ¾å›æ”¶è§¦å‘é˜€å€¼next_gcæ¨åˆ°ä¸€ä¸ªå¾ˆå¤§çš„å€¼ã€‚è€Œå½“æœåŠ¡æ­£å¸¸åï¼Œå› æ´»è·ƒå¯¹è±¡è¿œå°äºè¯¥é˜€å€¼ï¼Œé€ æˆåƒåœ¾å›æ”¶è¿Ÿè¿Ÿæ— æ³•è§¦å‘ï¼Œå¤§é‡ç™½è‰²å¯¹è±¡æ— æ³•å›æ”¶ï¼Œé€ æˆéšå½¢å†…å­˜æ³„æ¼ã€‚åŒæ ·æƒ…æ™¯ä¹Ÿæœ‰å¯èƒ½ç”±äºæŸä¸ªç®—æ³•åœ¨çŸ­æœŸå†…å¤§é‡ä½¿ç”¨ä¸´æ—¶å˜é‡é€ æˆ ã€‚&#xA;è¿™ä¸ªæ—¶å€™åªæœ‰forcegcä»‹å…¥ï¼Œæ‰èƒ½å°†next_gcæ¢å¤æ­£å¸¸ï¼Œ ç›‘æ§æœåŠ¡sysmonæ¯éš”ä¸¤åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡åƒåœ¾å›æ”¶çŠ¶æ€ï¼Œå¦‚æœè¶…è¿‡ä¸¤åˆ†é’Ÿæœªæ›¾è§¦å‘ï¼Œå°±ä¼šå¼ºåˆ¶æ‰§è¡Œgc&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;gc è¿‡ç¨‹ä¸­å‡ ç§è¾…åŠ©ç»“æ„&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;parfor å¹¶è¡Œä»»åŠ¡æ¡†æ¶ ï¼š å…³æ³¨çš„æ˜¯ä»»åŠ¡çš„åˆ†é…å’Œè°ƒåº¦ï¼Œè‡ªèº«ä¸å…·å¤‡æ‰§è¡Œèƒ½åŠ›ã€‚å®ƒå°†å¤šä¸ªä»»åŠ¡åˆ†ç»„äº¤ç»™å¤šä¸ªæ‰§è¡Œçº¿ç¨‹ã€‚ç„¶ååœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡æ–°å¹³è¡¡çº¿ç¨‹çš„ä»»åŠ¡åˆ†é…ï¼Œç¡®ä¿æ•´ä¸ªä»»åŠ¡åœ¨æœ€çŸ­çš„æ—¶é—´å†…å®Œæˆ&#xA;ç¼“å­˜é˜Ÿåˆ—ï¼š workbuf æ— é”æ ˆèŠ‚ç‚¹ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªç¼“å­˜å®¹å™¨&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;h3&gt;é—®é¢˜&lt;/h3&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;goç¨‹åºå†…å­˜å ç”¨å¤§çš„é—®é¢˜&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬æ¨¡æ‹Ÿå¤§é‡çš„ç”¨æˆ·è¯·æ±‚è®¿é—®åå°æœåŠ¡ï¼Œè¿™æ—¶å„æœåŠ¡æ¨¡å—èƒ½è§‚å¯Ÿåˆ°æ˜æ˜¾çš„å†…å­˜å ç”¨ä¸Šå‡ã€‚ä½†æ˜¯å½“åœæ­¢å‹æµ‹æ—¶ï¼Œå†…å­˜å ç”¨å¹¶æœªå‘ç”Ÿæ˜æ˜¾çš„ä¸‹é™ã€‚èŠ±äº†å¾ˆé•¿æ—¶é—´å®šä½é—®é¢˜ï¼Œä½¿ç”¨gprofç­‰å„ç§æ–¹æ³•ï¼Œä¾ç„¶æ²¡æœ‰å‘ç°åŸå› ã€‚æœ€åå‘ç°åŸæ¥è¿™æ—¶æ­£å¸¸çš„â€¦ä¸»è¦çš„åŸå› æœ‰ä¸¤ä¸ªï¼Œ&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸€æ˜¯goçš„åƒåœ¾å›æ”¶æœ‰ä¸ªè§¦å‘é˜ˆå€¼ï¼Œè¿™ä¸ªé˜ˆå€¼ä¼šéšç€æ¯æ¬¡å†…å­˜ä½¿ç”¨å˜å¤§è€Œé€æ¸å¢å¤§ï¼ˆå¦‚åˆå§‹é˜ˆå€¼æ˜¯10MBåˆ™ä¸‹ä¸€æ¬¡å°±æ˜¯20MBï¼Œå†ä¸‹ä¸€æ¬¡å°±æˆä¸ºäº†40MBâ€¦ï¼‰ï¼Œå¦‚æœé•¿æ—¶é—´æ²¡æœ‰è§¦å‘gc goä¼šä¸»åŠ¨è§¦å‘ä¸€æ¬¡ï¼ˆ2minï¼‰ã€‚é«˜å³°æ—¶å†…å­˜ä½¿ç”¨é‡ä¸Šå»åï¼Œé™¤éæŒç»­ç”³è¯·å†…å­˜ï¼Œé é˜ˆå€¼è§¦å‘gcå·²ç»åŸºæœ¬ä¸å¯èƒ½ï¼Œè€Œæ˜¯è¦ç­‰æœ€å¤š2minä¸»åŠ¨gcå¼€å§‹æ‰èƒ½è§¦å‘gcã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ç¬¬äºŒä¸ªåŸå› æ˜¯goè¯­è¨€åœ¨å‘ç³»ç»Ÿäº¤è¿˜å†…å­˜æ—¶åªæ˜¯å‘Šè¯‰ç³»ç»Ÿè¿™äº›å†…å­˜ä¸éœ€è¦ä½¿ç”¨äº†ï¼Œå¯ä»¥å›æ”¶ï¼›åŒæ—¶æ“ä½œç³»ç»Ÿä¼šé‡‡å–â€œæ‹–å»¶ç—‡â€ç­–ç•¥ï¼Œå¹¶ä¸æ˜¯ç«‹å³å›æ”¶ï¼Œè€Œæ˜¯ç­‰åˆ°ç³»ç»Ÿå†…å­˜ç´§å¼ æ—¶æ‰ä¼šå¼€å§‹å›æ”¶è¿™æ ·è¯¥ç¨‹åºåˆé‡æ–°ç”³è¯·å†…å­˜æ—¶å°±å¯ä»¥è·å¾—æå¿«çš„åˆ†é…é€Ÿåº¦ã€‚&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;gcæ—¶é—´é•¿çš„é—®é¢˜&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;å¯¹äºå¯¹ç”¨æˆ·å“åº”äº‹ä»¶æœ‰è¦æ±‚çš„åç«¯ç¨‹åºï¼Œgolang gcæ—¶çš„stop the worldå…¼èŒæ˜¯å™©æ¢¦ã€‚æ ¹æ®ä¸Šæ–‡çš„ä»‹ç»ï¼Œ1.5ç‰ˆæœ¬çš„goå†å®Œæˆä¸Šè¿°æ”¹è¿›ååº”è¯¥gcæ€§èƒ½ä¼šæå‡ä¸å°‘ï¼Œä½†æ˜¯æ‰€æœ‰çš„åƒåœ¾å›æ”¶å‹è¯­è¨€éƒ½éš¾å…åœ¨gcæ—¶é¢ä¸´æ€§èƒ½ä¸‹é™ï¼Œå¯¹æ­¤æˆ‘ä»¬å¯¹äºåº”è¯¥å°½é‡é¿å…é¢‘ç¹åˆ›å»ºä¸´æ—¶å †å¯¹è±¡ï¼ˆå¦‚&amp;amp;abc{}, new, makeç­‰ï¼‰ä»¥å‡å°‘åƒåœ¾æ”¶é›†æ—¶çš„æ‰«ææ—¶é—´ï¼Œå¯¹äºéœ€è¦é¢‘ç¹ä½¿ç”¨çš„ä¸´æ—¶å¯¹è±¡è€ƒè™‘ç›´æ¥é€šè¿‡æ•°ç»„ç¼“å­˜è¿›è¡Œé‡ç”¨ï¼›å¾ˆå¤šäººé‡‡ç”¨cgoçš„æ–¹æ³•è‡ªå·±ç®¡ç†å†…å­˜è€Œç»•å¼€åƒåœ¾æ”¶é›†ï¼Œè¿™ç§æ–¹æ³•é™¤éè¿«ä¸å¾—å·²ä¸ªäººæ˜¯ä¸æ¨èçš„ï¼ˆå®¹æ˜“é€ æˆä¸å¯é¢„çŸ¥çš„é—®é¢˜ï¼‰ï¼Œå½“ç„¶è¿«ä¸å¾—å·²çš„æƒ…å†µä¸‹è¿˜æ˜¯å¯ä»¥è€ƒè™‘çš„ï¼Œè¿™æ‹›å¸¦æ¥çš„æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„~&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;goroutineæ³„éœ²çš„é—®é¢˜&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬çš„ä¸€ä¸ªæœåŠ¡éœ€è¦å¤„ç†å¾ˆå¤šé•¿è¿æ¥è¯·æ±‚ï¼Œå®ç°æ—¶ï¼Œå¯¹äºæ¯ä¸ªé•¿è¿æ¥è¯·æ±‚å„å¼€äº†ä¸€ä¸ªè¯»å–å’Œå†™å…¥åç¨‹ï¼Œå…¨éƒ¨é‡‡ç”¨endless for loopä¸åœåœ°å¤„ç†æ”¶å‘æ•°æ®ã€‚å½“è¿æ¥è¢«è¿œç«¯å…³é—­åï¼Œå¦‚æœä¸å¯¹è¿™ä¸¤ä¸ªåç¨‹åšå¤„ç†ï¼Œä»–ä»¬ä¾ç„¶ä¼šä¸€ç›´è¿è¡Œï¼Œå¹¶ä¸”å ç”¨çš„channelä¹Ÿä¸ä¼šè¢«é‡Šæ”¾â€¦è¿™é‡Œå°±å¿…é¡»ååˆ†æ³¨æ„ï¼Œåœ¨ä¸ä½¿ç”¨åç¨‹åä¸€å®šè¦æŠŠä»–ä¾èµ–çš„channel closeå¹¶é€šè¿‡å†åç¨‹ä¸­åˆ¤æ–­channelæ˜¯å¦å…³é—­ä»¥ä¿è¯å…¶é€€å‡ºã€‚&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;å¦‚ä½•æµ‹é‡GC&lt;/h2&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ go build -gcflags &amp;quot;-l&amp;quot; -o test test.go&#xA;$ GODEBUG=&amp;quot;gctrace=1&amp;quot; ./test&#xA;&#xA;gctrace: setting gctrace=1 causes the garbage collector to emit a single line to standard&#xA;error at each collection, summarizing the amount of memory collected and the&#xA;length of the pause. Setting gctrace=2 emits the same summary but also&#xA;repeats each collection.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ä¹‹å‰è¯´äº†é‚£ä¹ˆå¤šï¼Œé‚£å¦‚ä½•æµ‹é‡gcçš„ä¹‹æ˜Ÿæ•ˆç‡ï¼Œåˆ¤æ–­å®ƒåˆ°åº•æ˜¯å¦å¯¹ç¨‹åºçš„è¿è¡Œé€ æˆäº†å½±å“å‘¢ï¼Ÿ ç¬¬ä¸€ç§æ–¹å¼æ˜¯è®¾ç½®godebugçš„ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚è¿è¡ŒGODEBUG=gctrace=1 ./myserverï¼Œå¦‚æœè¦æƒ³å¯¹äºè¾“å‡ºç»“æœäº†è§£ï¼Œè¿˜éœ€è¦å¯¹äºgcçš„åŸç†è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„æ·±å…¥åˆ†æï¼Œè¿™ç¯‡æ–‡ç« çš„å¥½å¤„åœ¨äºï¼Œæ¸…æ™°çš„ä¹‹å¤„äº†golangçš„gcæ—¶é—´æ˜¯ç”±å“ªäº›å› ç´ å†³å®šçš„ï¼Œå› æ­¤ä¹Ÿå¯ä»¥é’ˆå¯¹æ€§çš„é‡‡å–ä¸åŒçš„æ–¹å¼æå‡gcçš„æ—¶é—´ï¼š&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ ¹æ®ä¹‹å‰çš„åˆ†æä¹Ÿå¯ä»¥çŸ¥é“ï¼Œgolangä¸­çš„gcæ˜¯ä½¿ç”¨æ ‡è®°æ¸…æ¥šæ³•ï¼Œæ‰€ä»¥gcçš„æ€»æ—¶é—´ä¸ºï¼š&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Tgc = Tseq + Tmark + Tsweep(Tè¡¨ç¤ºtime)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Tseqè¡¨ç¤ºæ˜¯åœæ­¢ç”¨æˆ·çš„ goroutine å’Œåšä¸€äº›å‡†å¤‡æ´»åŠ¨ï¼ˆé€šå¸¸å¾ˆå°ï¼‰éœ€è¦çš„æ—¶é—´&#xA;Tmark æ˜¯å †æ ‡è®°æ—¶é—´ï¼Œæ ‡è®°å‘ç”Ÿåœ¨æ‰€æœ‰ç”¨æˆ· goroutine åœæ­¢æ—¶ï¼Œå› æ­¤å¯ä»¥æ˜¾è‘—åœ°å½±å“å¤„ç†çš„å»¶è¿Ÿ&#xA;Tsweep æ˜¯å †æ¸…é™¤æ—¶é—´ï¼Œæ¸…é™¤é€šå¸¸ä¸æ­£å¸¸çš„ç¨‹åºè¿è¡ŒåŒæ—¶å‘ç”Ÿï¼Œæ‰€ä»¥å¯¹å»¶è¿Ÿæ¥è¯´æ˜¯ä¸å¤ªå…³é”®çš„&#xA;ä¹‹åç²’åº¦è¿›ä¸€æ­¥ç»†åˆ†ï¼Œå…·ä½“çš„æ¦‚å¿µè¿˜æ˜¯æœ‰äº›ä¸å¤ªæ‡‚ï¼š&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸Tmarkç›¸å…³çš„ï¼š1 åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­ï¼Œå †ä¸­æ´»åŠ¨å¯¹è±¡çš„æ•°é‡ï¼Œ2 å¸¦æœ‰æŒ‡é’ˆçš„æ´»åŠ¨å¯¹è±¡å æ®çš„å†…å­˜æ€»é‡ 3 æ´»åŠ¨å¯¹è±¡ä¸­çš„æŒ‡é’ˆæ•°é‡ã€‚&#xA;ä¸Tsweepç›¸å…³çš„ï¼š1 å †å†…å­˜çš„æ€»é‡ 2 å †ä¸­çš„åƒåœ¾æ€»é‡&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;å¦‚ä½•è¿›è¡Œgcè°ƒä¼˜ï¼ˆgopherå¤§ä¼š Dannyï¼‰&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;ç¡¬æ€§å‚æ•°&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ¶‰åŠç®—æ³•çš„é—®é¢˜ï¼Œæ€»æ˜¯ä¼šæœ‰äº›å‚æ•°ã€‚GOGCå‚æ•°ä¸»è¦æ§åˆ¶çš„æ˜¯ä¸‹ä¸€æ¬¡gcå¼€å§‹çš„æ—¶å€™çš„å†…å­˜ä½¿ç”¨é‡ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ¯”å¦‚å½“å‰çš„ç¨‹åºä½¿ç”¨äº†4Mçš„å¯¹å†…å­˜ï¼ˆè¿™é‡Œè¯´çš„æ˜¯å †å†…å­˜ï¼‰ï¼Œå³æ˜¯è¯´ç¨‹åºå½“å‰reachableçš„å†…å­˜ä¸º4mï¼Œå½“ç¨‹åºå ç”¨çš„å†…å­˜è¾¾åˆ°reachable*(1+GOGC/100)=8Mçš„æ—¶å€™ï¼Œgcå°±ä¼šè¢«è§¦å‘ï¼Œå¼€å§‹è¿›è¡Œç›¸å…³çš„gcæ“ä½œã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;å¦‚ä½•å¯¹GOGCçš„å‚æ•°è¿›è¡Œè®¾ç½®ï¼Œè¦æ ¹æ®ç”Ÿäº§æƒ…å†µä¸­çš„å®é™…åœºæ™¯æ¥å®šï¼Œæ¯”å¦‚GOGCå‚æ•°æå‡ï¼Œæ¥å‡å°‘GCçš„é¢‘ç‡ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h3&gt;å‚è€ƒ&lt;/h3&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://blog.golang.org/go15gc&#34;&gt;go15gc&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://talks.golang.org/2015/go-gc.pdf&#34;&gt;https://talks.golang.org/2015/go-gc.pdf&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;http://dave.cheney.net/tag/godebug&#34;&gt;http://dave.cheney.net/tag/godebug&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://github.com/qyuhen/book&#34;&gt;1.5æºç åˆ†æ&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;http://www.open-open.com/lib/view/open1435846881544.html&#34;&gt;golang gc æ¢ç©¶&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;http://wangzhezhe.github.io/blog/2016/04/30/golang-gc/&#34;&gt;golang gc åŸºæœ¬çŸ¥è¯†&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;http://www.oschina.net/translate/debugging-performance-issues-in-go-programs&#34;&gt;go æ€§èƒ½è°ƒè¯•é—®é¢˜&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2016/goç¬”è®°-å…³äºGC.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>context åŒ…è§£è¯»</title>
    <updated>2016-07-31T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2016-07-31:/2016/context åŒ…è§£è¯».html</id>
    <content type="html">&lt;p&gt;&lt;code&gt;context&lt;/code&gt; åŒ…å›°æ‰°æˆ‘å¥½ä¹…ï¼Œä¹‹å‰åœ¨  &lt;code&gt;watch etcd&lt;/code&gt; çš„æ—¶å€™é¦–æ¬¡ä¸Šæ‰‹ä½¿ç”¨è¿™ä¸ªåŒ…ï¼Œå½“æ—¶å¹¶ä¸ç†è§£è¿™ä¸ªåŒ…çš„ä½œç”¨ï¼ŒåªçŸ¥é“å¯ä»¥ç”¨æ¥å…³é—­ &lt;code&gt;watch&lt;/code&gt; ï¼Œ åæ¥è¢«å¤§ç‰›åæ§½äº†ï¼Œå†³å®šæ·±å…¥æ¢ç©¶ä¸€ç•ªã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;ç®€ä»‹&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;golang&lt;/code&gt; ä¸­çš„åˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;code&gt;goroutine&lt;/code&gt; , å¹¶ä¸ä¼šè¿”å›åƒcè¯­è¨€ç±»ä¼¼çš„pidï¼Œæ‰€æœ‰æˆ‘ä»¬ä¸èƒ½ä»å¤–éƒ¨æ€æ­»æŸä¸ªgoroutineï¼Œæ‰€æœ‰æˆ‘å°±å¾—è®©å®ƒè‡ªå·±ç»“æŸï¼Œä¹‹å‰æˆ‘ä»¬ç”¨ &lt;code&gt;channel ï¼‹ select&lt;/code&gt; çš„æ–¹å¼ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æœ‰äº›åœºæ™¯å®ç°èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œä¾‹å¦‚ç”±ä¸€ä¸ªè¯·æ±‚è¡ç”Ÿå‡ºçš„å„ä¸ª &lt;code&gt;goroutine&lt;/code&gt; ä¹‹é—´éœ€è¦æ»¡è¶³ä¸€å®šçš„çº¦æŸå…³ç³»ï¼Œä»¥å®ç°ä¸€äº›è¯¸å¦‚æœ‰æ•ˆæœŸï¼Œä¸­æ­¢routineæ ‘ï¼Œä¼ é€’è¯·æ±‚å…¨å±€å˜é‡ä¹‹ç±»çš„åŠŸèƒ½ã€‚äºæ˜¯google å°±ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå¼€æºäº† &lt;code&gt;context&lt;/code&gt; åŒ…ã€‚ä½¿ç”¨ &lt;code&gt;context&lt;/code&gt; å®ç°ä¸Šä¸‹æ–‡åŠŸèƒ½çº¦å®šéœ€è¦åœ¨ä½ çš„æ–¹æ³•çš„ä¼ å…¥å‚æ•°çš„ç¬¬ä¸€ä¸ªä¼ å…¥ä¸€ä¸ª &lt;code&gt;context.Context&lt;/code&gt; ç±»å‹çš„å˜é‡ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;æºç å‰–æ&lt;/h4&gt;&#xA;&#xA;&lt;h6&gt;context.Context æ¥å£&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;context&lt;/code&gt; åŒ…çš„æ ¸å¿ƒ&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//  context åŒ…é‡Œçš„æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥è¢«å¤šä¸ª goroutine ä½¿ç”¨    &#xA;type Context interface {               &#xA;    // å½“Context è¢« canceled æˆ–æ˜¯ times out çš„æ—¶å€™ï¼ŒDone è¿”å›ä¸€ä¸ªè¢« closed çš„channel      &#xA;    Done() &amp;lt;-chan struct{}        &#xA;    &#xA;    // åœ¨ Done çš„ channelè¢«closed åï¼Œ Err ä»£è¡¨è¢«å…³é—­çš„åŸå›    &#xA;    Err() error &#xA;&#xA;    // å¦‚æœå­˜åœ¨ï¼ŒDeadline è¿”å›Contextå°†è¦å…³é—­çš„æ—¶é—´  &#xA;    Deadline() (deadline time.Time, ok bool)&#xA;&#xA;    // å¦‚æœå­˜åœ¨ï¼ŒValue è¿”å›ä¸ key ç›¸å…³äº†çš„å€¼ï¼Œä¸å­˜åœ¨è¿”å› nil  &#xA;    Value(key interface{}) interface{}&#xA;}      &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬ä¸éœ€è¦æ‰‹åŠ¨å®ç°è¿™ä¸ªæ¥å£ï¼Œ&lt;code&gt;context&lt;/code&gt; åŒ…å·²ç»ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ &lt;code&gt;Background()&lt;/code&gt;ï¼Œä¸€ä¸ªæ˜¯ &lt;code&gt;TODO()&lt;/code&gt;ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›ä¸€ä¸ª &lt;code&gt;Context&lt;/code&gt; çš„å®ä¾‹ã€‚åªæ˜¯è¿”å›çš„è¿™ä¸¤ä¸ªå®ä¾‹éƒ½æ˜¯ç©º &lt;code&gt;Context&lt;/code&gt;ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h6&gt;ä¸»è¦ç»“æ„&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;cancelCtx&lt;/code&gt; ç»“æ„ä½“ç»§æ‰¿äº† &lt;code&gt;Context&lt;/code&gt; ï¼Œå®ç°äº† &lt;code&gt;canceler&lt;/code&gt; æ–¹æ³•ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//*cancelCtx å’Œ *timerCtx éƒ½å®ç°äº†canceleræ¥å£ï¼Œå®ç°è¯¥æ¥å£çš„ç±»å‹éƒ½å¯ä»¥è¢«ç›´æ¥canceled&#xA;type canceler interface {&#xA;    cancel(removeFromParent bool, err error)&#xA;    Done() &amp;lt;-chan struct{}&#xA;}        &#xA;&#xA;type cancelCtx struct {&#xA;    Context&#xA;    done chan struct{} // closed by the first cancel call.&#xA;    mu       sync.Mutex&#xA;    children map[canceler]bool // set to nil by the first cancel call&#xA;    err      error             // å½“å…¶è¢«cancelæ—¶å°†ä¼šæŠŠerrè®¾ç½®ä¸ºénil&#xA;}&#xA;&#xA;func (c *cancelCtx) Done() &amp;lt;-chan struct{} {&#xA;    return c.done&#xA;}&#xA;&#xA;func (c *cancelCtx) Err() error {&#xA;    c.mu.Lock()&#xA;    defer c.mu.Unlock()&#xA;    return c.err&#xA;}&#xA;&#xA;func (c *cancelCtx) String() string {&#xA;    return fmt.Sprintf(&amp;quot;%v.WithCancel&amp;quot;, c.Context)&#xA;}&#xA;&#xA;//æ ¸å¿ƒæ˜¯å…³é—­c.done&#xA;//åŒæ—¶ä¼šè®¾ç½®c.err = err, c.children = nil&#xA;//ä¾æ¬¡éå†c.childrenï¼Œæ¯ä¸ªchildåˆ†åˆ«cancel&#xA;//å¦‚æœè®¾ç½®äº†removeFromParentï¼Œåˆ™å°†cä»å…¶parentçš„childrenä¸­åˆ é™¤&#xA;func (c *cancelCtx) cancel(removeFromParent bool, err error) {&#xA;    if err == nil {&#xA;        panic(&amp;quot;context: internal error: missing cancel error&amp;quot;)&#xA;    }&#xA;    c.mu.Lock()&#xA;    if c.err != nil {&#xA;        c.mu.Unlock()&#xA;        return // already canceled&#xA;    }&#xA;    c.err = err&#xA;    close(c.done)&#xA;    for child := range c.children {&#xA;        // NOTE: acquiring the child&#39;s lock while holding parent&#39;s lock.&#xA;        child.cancel(false, err)&#xA;    }&#xA;    c.children = nil&#xA;    c.mu.Unlock()&#xA;&#xA;    if removeFromParent {&#xA;        removeChild(c.Context, c) // ä»æ­¤å¤„å¯ä»¥çœ‹åˆ° cancelCtxçš„Contexté¡¹æ˜¯ä¸€ä¸ªç±»ä¼¼äºparentçš„æ¦‚å¿µ&#xA;    }&#xA;}         &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;timerCtx&lt;/code&gt; ç»“æ„ç»§æ‰¿ &lt;code&gt;cancelCtx&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;type timerCtx struct {&#xA;    cancelCtx //æ­¤å¤„çš„å°è£…ä¸ºäº†ç»§æ‰¿æ¥è‡ªäºcancelCtxçš„æ–¹æ³•ï¼ŒcancelCtx.Contextæ‰æ˜¯çˆ¶äº²èŠ‚ç‚¹çš„æŒ‡é’ˆ&#xA;    timer *time.Timer // Under cancelCtx.mu. æ˜¯ä¸€ä¸ªè®¡æ—¶å™¨&#xA;    deadline time.Time&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;valueCtx&lt;/code&gt; ç»“æ„ç»§æ‰¿ &lt;code&gt;cancelCtx&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;type valueCtx struct {&#xA;    Context&#xA;    key, val interface{}&#xA;}        &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h6&gt;ä¸»è¦æ–¹æ³•&lt;/h6&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;func WithCancel(parent Context) (ctx Context, cancel CancelFunc)&#xA;func WithDeadline(parent Context, deadline time.Time) (Context, CancelFunc)&#xA;func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc)&#xA;func WithValue(parent Context, key interface{}, val interface{}) Context&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;WithCancel&lt;/code&gt; å¯¹åº”çš„æ˜¯ &lt;code&gt;cancelCtx&lt;/code&gt; ,å…¶ä¸­ï¼Œè¿”å›ä¸€ä¸ª &lt;code&gt;cancelCtx&lt;/code&gt; ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ª &lt;code&gt;CancelFunc&lt;/code&gt;ï¼Œ&lt;code&gt;CancelFunc&lt;/code&gt; æ˜¯ &lt;code&gt;context&lt;/code&gt; åŒ…ä¸­å®šä¹‰çš„ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼š&lt;code&gt;type CancelFunc func()&lt;/code&gt;ã€‚è°ƒç”¨è¿™ä¸ª &lt;code&gt;CancelFunc&lt;/code&gt; æ—¶ï¼Œå…³é—­å¯¹åº”çš„c.doneï¼Œä¹Ÿå°±æ˜¯è®©ä»–çš„åä»£&lt;code&gt;goroutine&lt;/code&gt;é€€å‡ºã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;WithDeadline&lt;/code&gt; å’Œ &lt;code&gt;WithTimeout&lt;/code&gt; å¯¹åº”çš„æ˜¯ &lt;code&gt;timerCtx&lt;/code&gt; ï¼Œ&lt;code&gt;WithDeadline&lt;/code&gt; å’Œ &lt;code&gt;WithTimeout&lt;/code&gt; æ˜¯ç›¸ä¼¼çš„ï¼Œ&lt;code&gt;WithDeadline&lt;/code&gt; æ˜¯è®¾ç½®å…·ä½“çš„ &lt;code&gt;deadline&lt;/code&gt; æ—¶é—´ï¼Œåˆ°è¾¾ &lt;code&gt;deadline&lt;/code&gt; çš„æ—¶å€™ï¼Œåä»£ &lt;code&gt;goroutine&lt;/code&gt; é€€å‡ºï¼Œè€Œ WithTimeout ç®€å•ç²—æš´ï¼Œç›´æ¥ &lt;code&gt;return WithDeadline(parent, time.Now().Add(timeout))&lt;/code&gt;ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;WithValue&lt;/code&gt; å¯¹åº” &lt;code&gt;valueCtx&lt;/code&gt; ï¼Œ&lt;code&gt;WithValue&lt;/code&gt; æ˜¯åœ¨ &lt;code&gt;Context&lt;/code&gt; ä¸­è®¾ç½®ä¸€ä¸ª mapï¼Œæ‹¿åˆ°è¿™ä¸ª &lt;code&gt;Context&lt;/code&gt; ä»¥åŠå®ƒçš„åä»£çš„ &lt;code&gt;goroutine&lt;/code&gt; éƒ½å¯ä»¥æ‹¿åˆ° map é‡Œçš„å€¼ã€‚&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;è¯¦ç»† context åŒ…æºç è§£è¯»: &lt;a href=&#34;http://studygolang.com/articles/5131&#34;&gt;goæºç è§£è¯»&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;h4&gt;ä½¿ç”¨åŸåˆ™&lt;/h4&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;ä½¿ç”¨ &lt;code&gt;Context&lt;/code&gt; çš„ç¨‹åºåŒ…éœ€è¦éµå¾ªå¦‚ä¸‹çš„åŸåˆ™æ¥æ»¡è¶³æ¥å£çš„ä¸€è‡´æ€§ä»¥åŠä¾¿äºé™æ€åˆ†æ&lt;/li&gt;&#xA;&lt;li&gt;ä¸è¦æŠŠ &lt;code&gt;Context&lt;/code&gt; å­˜åœ¨ä¸€ä¸ªç»“æ„ä½“å½“ä¸­ï¼Œæ˜¾å¼åœ°ä¼ å…¥å‡½æ•°ã€‚&lt;code&gt;Context&lt;/code&gt; å˜é‡éœ€è¦ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨ï¼Œä¸€èˆ¬å‘½åä¸º&lt;code&gt;ctx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;å³ä½¿æ–¹æ³•å…è®¸ï¼Œä¹Ÿä¸è¦ä¼ å…¥ä¸€ä¸ª &lt;code&gt;nil&lt;/code&gt; çš„ &lt;code&gt;Context&lt;/code&gt; ï¼Œå¦‚æœä½ ä¸ç¡®å®šä½ è¦ç”¨ä»€ä¹ˆ &lt;code&gt;Context&lt;/code&gt; çš„æ—¶å€™ä¼ ä¸€ä¸ª &lt;code&gt;context.TODO&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;ä½¿ç”¨ &lt;code&gt;context&lt;/code&gt; çš„ &lt;code&gt;Value&lt;/code&gt; ç›¸å…³æ–¹æ³•åªåº”è¯¥ç”¨äºåœ¨ç¨‹åºå’Œæ¥å£ä¸­ä¼ é€’çš„å’Œè¯·æ±‚ç›¸å…³çš„å…ƒæ•°æ®ï¼Œä¸è¦ç”¨å®ƒæ¥ä¼ é€’ä¸€äº›å¯é€‰çš„å‚æ•°&lt;/li&gt;&#xA;&lt;li&gt;åŒæ ·çš„ &lt;code&gt;Context&lt;/code&gt; å¯ä»¥ç”¨æ¥ä¼ é€’åˆ°ä¸åŒçš„ &lt;code&gt;goroutine&lt;/code&gt; ä¸­ï¼Œ&lt;code&gt;Context&lt;/code&gt; åœ¨å¤šä¸ª&lt;code&gt;goroutine&lt;/code&gt; ä¸­æ˜¯å®‰å…¨çš„&lt;br /&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;h4&gt;ä½¿ç”¨ç¤ºä¾‹&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;ä¾‹å­copyè‡ª: &lt;a href=&#34;https://github.com/eleme/sre/blob/master/context.md&#34;&gt;å…³äº Golang ä¸­çš„ context åŒ…çš„ä»‹ç»&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package main&#xA;&#xA;import (&#xA;    &amp;quot;fmt&amp;quot;&#xA;    &amp;quot;time&amp;quot;&#xA;    &amp;quot;golang.org/x/net/context&amp;quot;&#xA;)&#xA;&#xA;// æ¨¡æ‹Ÿä¸€ä¸ªæœ€å°æ‰§è¡Œæ—¶é—´çš„é˜»å¡å‡½æ•°&#xA;func inc(a int) int {&#xA;    res := a + 1                // è™½ç„¶æˆ‘åªåšäº†ä¸€æ¬¡ç®€å•çš„ +1 çš„è¿ç®—,&#xA;    time.Sleep(1 * time.Second) // ä½†æ˜¯ç”±äºæˆ‘çš„æœºå™¨æŒ‡ä»¤é›†ä¸­æ²¡æœ‰è¿™æ¡æŒ‡ä»¤,&#xA;    // æ‰€ä»¥åœ¨æˆ‘æ‰§è¡Œäº† 1000000000 æ¡æœºå™¨æŒ‡ä»¤, ç»­äº† 1s ä¹‹å, æˆ‘æ‰ç»ˆäºå¾—åˆ°ç»“æœã€‚B)&#xA;    return res&#xA;}&#xA;&#xA;// å‘å¤–éƒ¨æä¾›çš„é˜»å¡æ¥å£&#xA;// è®¡ç®— a + b, æ³¨æ„ a, b å‡ä¸èƒ½ä¸ºè´Ÿ&#xA;// å¦‚æœè®¡ç®—è¢«ä¸­æ–­, åˆ™è¿”å› -1&#xA;func Add(ctx context.Context, a, b int) int {&#xA;    res := 0&#xA;    for i := 0; i &amp;lt; a; i++ {&#xA;        res = inc(res)&#xA;        select {&#xA;        case &amp;lt;-ctx.Done():&#xA;            return -1&#xA;        default:&#xA;        }&#xA;    }&#xA;    for i := 0; i &amp;lt; b; i++ {&#xA;        res = inc(res)&#xA;        select {&#xA;        case &amp;lt;-ctx.Done():&#xA;            return -1&#xA;        default:&#xA;        }&#xA;    }&#xA;    return res&#xA;}&#xA;&#xA;func main() {&#xA;    {&#xA;        // ä½¿ç”¨å¼€æ”¾çš„ API è®¡ç®— a+b&#xA;        a := 1&#xA;        b := 2&#xA;        timeout := 2 * time.Second&#xA;        ctx, _ := context.WithTimeout(context.Background(), timeout)&#xA;        res := Add(ctx, 1, 2)&#xA;        fmt.Printf(&amp;quot;Compute: %d+%d, result: %d\n&amp;quot;, a, b, res)&#xA;    }&#xA;    {&#xA;        // æ‰‹åŠ¨å–æ¶ˆ&#xA;        a := 1&#xA;        b := 2&#xA;        ctx, cancel := context.WithCancel(context.Background())&#xA;        go func() {&#xA;            time.Sleep(2 * time.Second)&#xA;            cancel() // åœ¨è°ƒç”¨å¤„ä¸»åŠ¨å–æ¶ˆ&#xA;        }()&#xA;        res := Add(ctx, 1, 2)&#xA;        fmt.Printf(&amp;quot;Compute: %d+%d, result: %d\n&amp;quot;, a, b, res)&#xA;    }&#xA;}&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å®˜æ–¹å®Œæ•´ç¤ºä¾‹:&lt;br /&gt;&#xA;&lt;a href=&#34;https://blog.golang.org/context/server/server.go&#34;&gt;server&lt;/a&gt;&lt;br /&gt;&#xA;&lt;a href=&#34;https://blog.golang.org/context/userip/userip.go&#34;&gt;userip&lt;/a&gt;&lt;br /&gt;&#xA;&lt;a href=&#34;https://blog.golang.org/context/google/google.go&#34;&gt;google&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;éƒ¨åˆ†å‚è€ƒï¼š&lt;br /&gt;&#xA;&lt;a href=&#34;http://studygolang.com/articles/5131&#34;&gt;goæºç è§£è¯»&lt;/a&gt;&lt;br /&gt;&#xA;&lt;a href=&#34;https://github.com/eleme/sre/blob/master/context.md&#34;&gt;å…³äº Golang ä¸­çš„ context åŒ…çš„ä»‹ç»&lt;/a&gt;&lt;br /&gt;&#xA;&lt;a href=&#34;http://blog.golang.org/context&#34;&gt;å®˜æ–¹åšå®¢&lt;/a&gt;&lt;br /&gt;&#xA;Thanks&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2016/context åŒ…è§£è¯».html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>åˆè¯† Docker</title>
    <updated>2016-06-23T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2016-06-23:/2016/åˆè¯† Docker.html</id>
    <content type="html">&lt;p&gt;Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œä½¿ç”¨ golang å¼€å‘å®ç°ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚&lt;br /&gt;&#xA;Docker é¡¹ç›®çš„ç›®æ ‡æ˜¯å®ç°è½»é‡çº§çš„æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–è§£å†³æ–¹æ¡ˆã€‚ Docker çš„åŸºç¡€æ˜¯ Linux å®¹å™¨ï¼ˆLXCï¼‰ç­‰æŠ€æœ¯ã€‚&lt;br /&gt;&#xA;åœ¨ LXC çš„åŸºç¡€ä¸Š Docker è¿›è¡Œäº†è¿›ä¸€æ­¥çš„å°è£…ï¼Œè®©ç”¨æˆ·ä¸éœ€è¦å»å…³å¿ƒå®¹å™¨çš„ç®¡ç†ï¼Œä½¿å¾—æ“ä½œæ›´ä¸ºç®€ä¾¿ã€‚ç”¨æˆ·æ“ä½œ Docker çš„å®¹å™¨å°±åƒæ“ä½œä¸€ä¸ªå¿«é€Ÿè½»é‡çº§çš„è™šæ‹Ÿæœºä¸€æ ·ç®€å•&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;Docker ç»„æˆ&lt;/h4&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Image - é•œåƒ&lt;/li&gt;&#xA;&lt;li&gt;Containter - å®¹å™¨&lt;/li&gt;&#xA;&lt;li&gt;Docker hub - ä»“åº“&lt;br /&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;h4&gt;å®‰è£… Docker&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;å®‰è£… Docker è¦æ±‚ linux å†…æ ¸ç‰ˆæœ¬ä¸ä½äº 3.13ï¼ŒDocker ä¾èµ– linux å†…æ ¸ï¼Œä½¿ç”¨ linux çš„ namespae å®ç°è¿›ç¨‹çš„éš”ç¦»ï¼Œcgroup æ¥å¯¹èµ„æºçš„æ§åˆ¶ã€‚(docker ä¸ linux å†…æ ¸çš„å…³ç³»ä»¥åå•ç‹¬ç ”ç©¶ï¼Œå…¶å®ç›®å‰æˆ‘ä¸æ˜¯å¤ªæ¸…æ¥šï¼Œä¸æ•¢çè¯´) å¦‚æœä½ çš„å†…æ ¸ç‰ˆæœ¬ä½äº 3.13ï¼Œè¯·è‡ªè¡Œ google å‡çº§å†…æ ¸ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æŸ¥çœ‹è‡ªå·±å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ uname -a&#xA;Linux Host 3.16.0-43-generic #58~14.04.1-Ubuntu SMP Mon Jun 22 10:21:20 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æˆ–è€…&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ cat /proc/version&#xA;Linux version 3.16.0-43-generic (buildd@brownie) (gcc version 4.8.2 (Ubuntu 4.8.2-19ubuntu1) ) #58~14.04.1-Ubuntu SMP Mon Jun 22 10:21:20 UTC 2015&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;Ubuntu å®‰è£…&lt;/h4&gt;&#xA;&#xA;&lt;h6&gt;æ›´æ–°APTé•œåƒæº&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;å®‰è£… apt-transport-https åŒ…æ”¯æŒ https åè®®çš„æº&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; $ sudo apt-get update &#xA; $ sudo apt-get install apt-transport-https ca-certificates&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ·»åŠ æ–°çš„ gpg å¯†é’¥&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D   &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ·»åŠ  Docker çš„å®˜æ–¹ apt è½¯ä»¶æº&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo cat &amp;lt;&amp;lt;EOF &amp;gt; /etc/apt/sources.list.d/docker.list&#xA;deb https://apt.dockerproject.org/repo ubuntu-trusty main&#xA;EOF  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;é trusty ç‰ˆæœ¬çš„ç³»ç»Ÿæ³¨æ„ä¿®æ”¹ä¸ºè‡ªå·±å¯¹åº”çš„ä»£å·&lt;br /&gt;&#xA;deb &lt;a href=&#34;https://apt.dockerproject.org/repo&#34;&gt;https://apt.dockerproject.org/repo&lt;/a&gt; ubuntu-precise main&lt;br /&gt;&#xA;deb &lt;a href=&#34;https://apt.dockerproject.org/repo&#34;&gt;https://apt.dockerproject.org/repo&lt;/a&gt; ubuntu-trusty main&lt;br /&gt;&#xA;deb &lt;a href=&#34;https://apt.dockerproject.org/repo&#34;&gt;https://apt.dockerproject.org/repo&lt;/a&gt; ubuntu-wily main&lt;br /&gt;&#xA;deb &lt;a href=&#34;https://apt.dockerproject.org/repo&#34;&gt;https://apt.dockerproject.org/repo&lt;/a&gt; ubuntu-xenial main&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;æ›´æ–° apt è½¯ä»¶åŒ…ç¼“å­˜&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-get update   &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨è€ç‰ˆæœ¬çš„ Dockerï¼Œè¯·å…ˆåˆ é™¤&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-get purge lxc-docker    &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ£€æŸ¥ apt æºæ˜¯å¦å‘ç”Ÿæ”¹å˜&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ apt-cache policy docker-engine   &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h6&gt;æ›´æ–°ç³»ç»Ÿå†…æ ¸å’Œå®‰è£…å¯èƒ½éœ€è¦çš„è½¯ä»¶åŒ…&lt;/h6&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-get install linux-image-extra-$(uname -r)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;code&gt;linux-image-extra&lt;/code&gt; å…è®¸ä½ ä½¿ç”¨ &lt;code&gt;aufs&lt;/code&gt; æ–‡ä»¶ç³»ç»Ÿ&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;h6&gt;å®‰è£… Docker&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;æ›´æ–° apt æº&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-get update &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å®‰è£… Docker&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo apt-get install docker-engine     &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å¯åŠ¨ Docker å®ˆæŠ¤è¿›ç¨‹&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo service docker start  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ£€æŸ¥ Docker æ˜¯å¦å®‰è£…æˆåŠŸ&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo docker run hello-world  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h6&gt;ä½¿ç”¨è„šæœ¬å®‰è£… Docker&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;ä½¿ç”¨å®˜æ–¹æä¾›çš„å®‰è£…è„šæœ¬, ä½¿ç”¨è„šæœ¬æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿è¡Œï¼Œä¹‹å‰çš„æ­¥éª¤éƒ½å¯ä»¥çœç•¥&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo-i&#xA;$ wget -qO- https://get.docker.com/ | sh  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h6&gt;æŠŠå½“å‰ç”¨æˆ·åŠ å…¥ Docker ç”¨æˆ·ç»„&lt;/h6&gt;&#xA;&#xA;&lt;p&gt;è¿è¡Œ Docker éœ€ root æƒé™ï¼Œ ä¸ºäº†æˆ‘ä»¬ä¸å¿…ä¸€ç›´ä½¿ç”¨ root æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç”¨æˆ·åŠ è¿› Docker ç”¨æˆ·ç»„&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ sudo usermod -a -G docker [username]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Ubuntu is all set up!&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2016/åˆè¯† Docker.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>jQuery ä¸­ attr() å’Œ prop() æ–¹æ³•</title>
    <updated>2016-03-09T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2016-03-09:/2016/jQuery ä¸­ attr() å’Œ prop() æ–¹æ³•.html</id>
    <content type="html">&lt;p&gt;æ˜¨å¤©åœ¨ä½¿ç”¨JQueryå®ç°ä¸€ä¸ªä¸€é”®å…¨é€‰çš„åŠŸèƒ½çš„æ—¶å€™ï¼Œåœ¨è®¾ç½® &lt;code&gt;checkbox&lt;/code&gt; å±æ€§åï¼Œåªæ˜¯åœ¨ç¬¬ä¸€æœ‰æ•ˆï¼Œè¿‡åçš„Næ¬¡ä¸€ç›´æ— æ³•æ”¹å˜ã€‚ä¸€å¼€å§‹è¿˜ä»¥ä¸ºè‡ªå·±ä»£ç æ˜¯ä¸æ˜¯ç¥é©¬åœ°æ–¹çš„é€»è¾‘å‡ºäº†é—®é¢˜ï¼Œå¯æ˜¯åœ¨æ£€æŸ¥çš„å¤šæ¬¡ä¹‹åä¾ç„¶æ— æ³•æ‰¾åˆ°ç­”æ¡ˆï¼Œæœ€ååªèƒ½æ±‚åŠ©Google(æŒ‰å¸¸ç†æ¥è¯´ä¸€èˆ¬å…ˆç¿»æ–‡æ¡£),å…ˆä¸Šæˆ‘ä¹‹å‰å‡ºé—®é¢˜çš„ä»£ç ã€‚&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;(function() {&#xA;    var dom = {&#xA;        dbTransferAll : $(&#39;#dbTransferAll&#39;),&#xA;        dbCollections : $(&amp;quot;form div:first input[name=&#39;collection&#39;]&amp;quot;)&#xA;    }&#xA;&#xA;    var dbTransfer = {&#xA;        init : function() {&#xA;            this.eventFn();&#xA;        },&#xA;&#xA;        eventFn : function() {&#xA;            dom.dbTransferAll.bind(&#39;click&#39;,function() {&#xA;                &#xA;                if (this.checked == true) {&#xA;                    dom.dbCollections.attr(&amp;quot;checked&amp;quot;,true);&#xA;                } else {&#xA;                    dom.dbCollections.attr(&amp;quot;checked&amp;quot;, false); &#xA;                }&#xA;                &#xA;            });&#xA;        }&#xA;    }&#xA;    dbTransfer.init();&#xA;})();&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æœ€åé€šè¿‡è¯¸ä½å¤§ç¥çš„åšå®¢å¾—çŸ¥ï¼Œæ˜¯ä½¿ç”¨äº† &lt;code&gt;attr()&lt;/code&gt; æ–¹æ³•çš„é—®é¢˜ï¼Œ åœ¨JQueryåœ¨1.6ç‰ˆæœ¬ä¹‹åæ–°å¢äº†ä¸€ä¸ª &lt;code&gt;prop()&lt;/code&gt; æ–¹æ³•(ç¾æ„§å•Šï¼ä¸€ç›´ä¸çŸ¥é“),åº”è¯¥ä½¿ç”¨ &lt;code&gt;prop()&lt;/code&gt; æ–¹æ³•æ›¿æ¢ &lt;code&gt;attr()&lt;/code&gt; ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;ä¸ºä»€ä¹ˆè¦æ–°åŠ  &lt;code&gt;prop()&lt;/code&gt; æ–¹æ³•&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;jQuery 1.6ä¹‹å‰ ï¼Œ&lt;code&gt;attr()&lt;/code&gt; æ–¹æ³•åœ¨å–æŸäº› &lt;code&gt;attribute&lt;/code&gt; çš„å€¼æ—¶ï¼Œä¼šè¿”å› &lt;code&gt;property&lt;/code&gt; çš„å€¼ï¼Œè¿™å°±å¯¼è‡´äº†ç»“æœçš„ä¸ä¸€è‡´ã€‚ä» jQuery 1.6 å¼€å§‹ï¼Œ &lt;code&gt;prop()&lt;/code&gt; æ–¹æ³• æ–¹æ³•è¿”å› &lt;code&gt;property&lt;/code&gt; çš„å€¼,è€Œ &lt;code&gt;attr()&lt;/code&gt; æ–¹æ³•è¿”å› &lt;code&gt;attributes&lt;/code&gt; çš„å€¼ã€‚&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;attributeå’Œpropertyçš„åŒºåˆ«&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;attribute&lt;/code&gt; ç¿»è¯‘æˆä¸­æ–‡æœ¯è¯­ä¸ºâ€œç‰¹æ€§â€ï¼Œ&lt;code&gt;property&lt;/code&gt; ç¿»è¯‘æˆä¸­æ–‡æœ¯è¯­ä¸ºâ€œå±æ€§â€ï¼Œä»ä¸­æ–‡çš„å­—é¢æ„æ€æ¥çœ‹ï¼Œç¡®å®æ˜¯æœ‰ç‚¹åŒºåˆ«äº†ï¼Œå…ˆæ¥è¯´è¯´&lt;code&gt;attribute&lt;/code&gt; ã€‚&lt;br /&gt;&#xA;attributeæ˜¯ä¸€ä¸ªç‰¹æ€§èŠ‚ç‚¹ï¼Œæ¯ä¸ªDOMå…ƒç´ éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ &lt;code&gt;attributes&lt;/code&gt; å±æ€§æ¥å­˜æ”¾æ‰€æœ‰çš„ &lt;code&gt;attribute&lt;/code&gt; èŠ‚ç‚¹ï¼Œ&lt;code&gt;attributes&lt;/code&gt; æ˜¯ä¸€ä¸ªç±»æ•°ç»„çš„å®¹å™¨ï¼Œè¯´å¾—å‡†ç¡®ç‚¹å°±æ˜¯ &lt;code&gt;NameNodeMap&lt;/code&gt;ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„ä½†åˆå’Œæ•°ç»„ä¸å¤ªä¸€æ ·çš„å®¹å™¨ã€‚&lt;code&gt;attributes&lt;/code&gt; çš„æ¯ä¸ªæ•°å­—ç´¢å¼•ä»¥åå€¼å¯¹ &lt;code&gt;(name=â€valueâ€)&lt;/code&gt; çš„å½¢å¼å­˜æ”¾äº†ä¸€ä¸ª &lt;code&gt;attribute&lt;/code&gt; èŠ‚ç‚¹ã€‚&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;quot;box&amp;quot; id=&amp;quot;box&amp;quot; gameid=&amp;quot;880&amp;quot;&amp;gt;hello&amp;lt;/div&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ä¸Šé¢çš„divå…ƒç´ çš„HTMLä»£ç ä¸­æœ‰classã€idè¿˜æœ‰è‡ªå®šä¹‰çš„gameidï¼Œè¿™äº›ç‰¹æ€§éƒ½å­˜æ”¾åœ¨attributesä¸­ï¼Œç±»ä¼¼ä¸‹é¢çš„å½¢å¼ï¼š&#xA;view sourceprint?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[ class=&amp;quot;box&amp;quot;, id=&amp;quot;box&amp;quot;, gameid=&amp;quot;880&amp;quot; ]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;property&lt;/code&gt; å°±æ˜¯ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæŠŠDOMå…ƒç´ çœ‹æˆæ˜¯ä¸€ä¸ªæ™®é€šçš„ &lt;code&gt;Object&lt;/code&gt; å¯¹è±¡ï¼Œé‚£ä¹ˆ &lt;code&gt;property&lt;/code&gt; å°±æ˜¯ä¸€ä¸ªä»¥åå€¼å¯¹&lt;code&gt;(name=â€valueâ€)&lt;/code&gt; çš„å½¢å¼å­˜æ”¾åœ¨ &lt;code&gt;Object&lt;/code&gt; ä¸­çš„å±æ€§ã€‚è¦æ·»åŠ å’Œåˆ é™¤ &lt;code&gt;property&lt;/code&gt; ä¹Ÿç®€å•å¤šäº†ï¼Œå’Œæ™®é€šçš„å¯¹è±¡æ²¡å•¥åˆ†åˆ«ã€‚&lt;br /&gt;&#xA;ä¹‹æ‰€ä»¥ &lt;code&gt;attribute&lt;/code&gt; å’Œ &lt;code&gt;property&lt;/code&gt; å®¹æ˜“æ··å€„åœ¨ä¸€èµ·çš„åŸå› æ˜¯ï¼Œå¾ˆå¤š &lt;code&gt;attribute&lt;/code&gt; èŠ‚ç‚¹è¿˜æœ‰ä¸€ä¸ªç›¸å¯¹åº”çš„ &lt;code&gt;property&lt;/code&gt; å±æ€§ï¼Œæ¯”å¦‚ä¸Šé¢çš„ &lt;code&gt;div&lt;/code&gt; å…ƒç´ çš„ &lt;code&gt;id&lt;/code&gt; å’Œ &lt;code&gt;class&lt;/code&gt; æ—¢æ˜¯ &lt;code&gt;attribute&lt;/code&gt; ï¼Œä¹Ÿæœ‰å¯¹åº”çš„ &lt;code&gt;property&lt;/code&gt; ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ–¹æ³•éƒ½å¯ä»¥è®¿é—®å’Œä¿®æ”¹ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;DOMå…ƒç´ ä¸€äº›é»˜è®¤å¸¸è§çš„ &lt;code&gt;attribute&lt;/code&gt; èŠ‚ç‚¹éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„ &lt;code&gt;property&lt;/code&gt; å±æ€§ï¼Œæ¯”è¾ƒç‰¹æ®Šçš„æ˜¯ä¸€äº›å€¼ä¸º &lt;code&gt;Boolean&lt;/code&gt; ç±»å‹çš„&lt;code&gt;property&lt;/code&gt;(è¿™ä¸ªåœ°æ–¹&lt;code&gt;attr()&lt;/code&gt;ä¸&lt;code&gt;prop()&lt;/code&gt;ä¸åŒç‚¹)ï¼Œå¦‚ä¸€äº›è¡¨å•å…ƒç´ ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;quot;radio&amp;quot; checked=&amp;quot;checked&amp;quot; id=&amp;quot;raido&amp;quot;&amp;gt;&#xA;var radio = document.getElementById( &#39;radio&#39; );&#xA;console.log( radio.getAttribute(&#39;checked&#39;) ); // checked&#xA;console.log( radio.checked ); // true&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å¯¹äºè¿™äº›ç‰¹æ®Šçš„&lt;code&gt;attribute&lt;/code&gt;èŠ‚ç‚¹ï¼Œåªæœ‰å­˜åœ¨è¯¥èŠ‚ç‚¹ï¼Œå¯¹åº”çš„&lt;code&gt;property&lt;/code&gt; çš„å€¼å°±ä¸ºtrueï¼Œå¦‚ï¼š&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;quot;radio&amp;quot; checked=&amp;quot;anything&amp;quot; id=&amp;quot;raido&amp;quot;&amp;gt;&#xA;var radio = document.getElementById( &#39;radio&#39; );&#xA;console.log( radio.getAttribute(&#39;checked&#39;) ); // anything&#xA;console.log( radio.checked ); // true&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æœ€åä¸ºäº†æ›´å¥½çš„åŒºåˆ†&lt;code&gt;attribute&lt;/code&gt;å’Œ&lt;code&gt;property&lt;/code&gt;ï¼ŒåŸºæœ¬å¯ä»¥æ€»ç»“ä¸º&lt;code&gt;attribute&lt;/code&gt;èŠ‚ç‚¹éƒ½æ˜¯åœ¨HTMLä»£ç ä¸­å¯è§çš„ï¼Œè€Œ&lt;code&gt;property&lt;/code&gt;åªæ˜¯ä¸€ä¸ªæ™®é€šçš„åå€¼å¯¹å±æ€§ã€‚&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// gameidå’Œidéƒ½æ˜¯attributeèŠ‚ç‚¹&#xA;// idåŒæ—¶åˆå¯ä»¥é€šè¿‡propertyæ¥è®¿é—®å’Œä¿®æ”¹&#xA;&amp;lt;div gameid=&amp;quot;880&amp;quot; id=&amp;quot;box&amp;quot;&amp;gt;hello&amp;lt;/div&amp;gt;&#xA;// areaidä»…ä»…æ˜¯property&#xA;elem.areaid = 900;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;ç¥é©¬æ—¶å€™ä½¿ç”¨ &lt;code&gt;attr()&lt;/code&gt; ? ç¥é©¬æ—¶å€™ä½¿ç”¨ &lt;code&gt;prop()&lt;/code&gt; ?&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;æ ¹æ®å®˜æ–¹çš„å»ºè®®ï¼šå…·æœ‰ &lt;code&gt;true&lt;/code&gt; å’Œ &lt;code&gt;false&lt;/code&gt; ä¸¤ä¸ªå±æ€§çš„å±æ€§ï¼Œå¦‚ &lt;code&gt;checked&lt;/code&gt;, &lt;code&gt;selected&lt;/code&gt; æˆ–è€… &lt;code&gt;disabled&lt;/code&gt; ä½¿ç”¨&lt;code&gt;prop()&lt;/code&gt;ï¼Œå…¶ä»–çš„ä½¿ç”¨ &lt;code&gt;attr()&lt;/code&gt; ã€‚&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;æ–‡ç« éƒ¨åˆ†å‚è€ƒ &lt;a href=&#34;http://stylechen.com/attribute-property.html&#34;&gt;attributeå’Œpropertyçš„åŒºåˆ«&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2016/jQuery ä¸­ attr() å’Œ prop() æ–¹æ³•.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>golang ç¼–ç¨‹åŸºç¡€ - Hello,Word</title>
    <updated>2015-12-02T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2015-12-02:/2015/golang ç¼–ç¨‹åŸºç¡€ - Hello,Word.html</id>
    <content type="html">&lt;p&gt;æœ€è¿‘è¶Šå‘è§‰å¾—è‡ªå·±çš„golangåŸºç¡€è¿˜æ˜¯ä¸å¤Ÿæ‰å®,æ‰€æœ‰å†³å®šå†ä»å¤´æ‹ä¸€égolangçš„åŸºç¡€çŸ¥è¯†&#xA;åŒæ—¶ä¹Ÿä¸ºgolangçš„çˆ±å¥½è€…ä»¬æä¾›ç‚¹å…¥é—¨ææ–™.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬å°±ä»è¿™ä¸ªç»å…¸çš„ &lt;code&gt;Hello Word&lt;/code&gt; æ¡ˆä¾‹å¼€å§‹å§!(å…ˆä¸Šä»£ç )&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//HelloWord.go&#xA;package main&#xA;&#xA;import &amp;quot;fmt&amp;quot;&#xA;&#xA;func main() {&#xA;    fmt.Println(&amp;quot;Hello, Word&amp;quot;)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ¥ç€æˆ‘ä»¬æ‰“å¼€ç»ˆç«¯&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ cd $GOPATH/src/***    //è¿›å…¥ä½ çš„æ–‡ä»¶ç›®å½• &#xA;$ go run helloWord.go  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ¯«ä¸æ„å¤–,å‘½ä»¤ä¼šè¾“å‡º&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Hello,Word&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·æ¥å¹²&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ go build helloWord.go  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;è¿™æ ·ä½ ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ªå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶,ä¸éœ€è¦ä»»ä½•å…¶ä»–å¤„ç†ä¸‹,ä½ å°±å¯ä»¥åœ¨ä»»ä½•æ—¶é—´æ¥è¿è¡Œè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶äº†(æ³¨ï¼šå› ä¸ºæ˜¯é™æ€ç¼–è¯‘ï¼Œæ‰€ä»¥ä¹Ÿä¸ç”¨æ‹…å¿ƒåœ¨ç³»ç»Ÿåº“æ›´æ–°çš„æ—¶å€™å†²çªï¼Œå¹¸ç¦æ„Ÿæ»¡æ»¡)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ ./helloWord&#xA;Helllo,Word&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h4&gt;ä»£ç è¯¦è§£&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;çœ‹åˆ°ä»£ç çš„ç¬¬ä¸€è¡Œ,ç†Ÿæ‚‰ Java,Python çš„åŒå­¦ä¼šè§‰å¾—å¾ˆç†Ÿæ‚‰,æ²¡é”™golangä¹Ÿæ˜¯ä½¿ç”¨ &lt;code&gt;package&lt;/code&gt; çš„æ¥ç»„ç»‡ä»£ç çš„, ä¸€ä¸ª &lt;code&gt;package&lt;/code&gt; ä¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª&lt;code&gt;.go&lt;/code&gt;ç»“æŸçš„æºä»£ç æ–‡ä»¶ã€‚æ¯ä¸€ä¸ªæºæ–‡ä»¶éƒ½æ˜¯ä»¥ä¸€ä¸ª &lt;code&gt;package xxx&lt;/code&gt;çš„å£°æ˜å¼€å¤´çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­é‡Œå°±æ˜¯ &lt;code&gt;package main&lt;/code&gt; ã€‚è¿™è¡Œå£°æ˜è¡¨ç¤ºè¯¥æ–‡ä»¶æ˜¯å±äºå“ªä¸€ä¸ª &lt;code&gt;package&lt;/code&gt;ï¼Œç´§è·Ÿç€æ˜¯ä¸€ç³»åˆ— &lt;code&gt;import&lt;/code&gt; çš„ &lt;code&gt;package&lt;/code&gt; åï¼Œè¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶ä¸­å¼•å…¥çš„ &lt;code&gt;package&lt;/code&gt; ã€‚å†ä¹‹åæ˜¯æœ¬æ–‡ä»¶æœ¬èº«çš„ä»£ç &lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;main.main ä¸ºå‡½æ•°çš„å…¥å£(mainåŒ… mainå‡½æ•°)&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;ä»£ç çš„ç¬¬äºŒå¥ç›¸ä¿¡å¤§å®¶ä¹Ÿéƒ½çŒœåˆ°äº†,å¯¼å…¥ &lt;code&gt;fmt&lt;/code&gt; åŒ…,&lt;br /&gt;&#xA;&lt;code&gt;fmt&lt;/code&gt; åŒ…æ˜¯å¹²ä»€ä¹ˆçš„å‘¢?&lt;br /&gt;&#xA;&lt;code&gt;fmt&lt;/code&gt; åŒ…å®ç°äº†ç±»ä¼¼ &lt;code&gt;C&lt;/code&gt; è¯­è¨€ &lt;code&gt;printf&lt;/code&gt; å’Œ &lt;code&gt;scanf&lt;/code&gt; çš„æ ¼å¼åŒ– &lt;code&gt;I/O&lt;/code&gt; ã€‚æ ¼å¼åŒ–åŠ¨ä½œï¼ˆ&amp;rsquo;verb&amp;rsquo;ï¼‰æºè‡ªCè¯­è¨€ä½†æ›´ç®€å•ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ¥ä¸‹è®©æˆ‘ä»¬æ¥çœ‹ &lt;code&gt;main&lt;/code&gt; å‡½æ•°, &lt;code&gt;main&lt;/code&gt; å¿…é¡»å­˜åœ¨ä¸ &lt;code&gt;main&lt;/code&gt; åŒ…å†…, è¿™æ˜¯æˆ‘ä»¬æ•´ä¸ªç¨‹åºçš„å…¥å£(æ³¨ï¼šå…¶å®cç³»è¯­è¨€å·®ä¸å¤šéƒ½æ˜¯è¿™æ ·)ã€‚mainå‡½æ•°æ‰€åšçš„äº‹æƒ…å°±æ˜¯æˆ‘ä»¬ç¨‹åºåšçš„äº‹æƒ…ã€‚å½“ç„¶äº†ï¼Œ&lt;code&gt;main&lt;/code&gt; å‡½æ•°ä¸€èˆ¬å®Œæˆçš„å·¥ä½œæ˜¯è°ƒç”¨å…¶å®ƒ &lt;code&gt;packge&lt;/code&gt; é‡Œçš„å‡½æ•°æ¥å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œæ¯”å¦‚ &lt;code&gt;fmt.Println&lt;/code&gt; ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;main&lt;/code&gt; å‡½æ•°å†…æˆ‘ä»¬è°ƒç”¨äº† &lt;code&gt;fmt&lt;/code&gt; åŒ…é‡Œé¢å®šä¹‰çš„å‡½æ•° &lt;code&gt;Println&lt;/code&gt;ã€‚å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯é€šè¿‡&lt;code&gt;&amp;lt;pkgName&amp;gt;.&amp;lt;funcName&amp;gt;&lt;/code&gt;çš„æ–¹å¼è°ƒç”¨çš„.&lt;br /&gt;&#xA;&lt;code&gt;Println&lt;/code&gt; å‡½æ•°ç±»ä¼¼ä¸ c è¯­è¨€çš„ &lt;code&gt;printf&lt;/code&gt; ,åªæ˜¯åœ¨ &lt;code&gt;printf&lt;/code&gt; å‡½æ•°çš„åŸºç¡€ä¸Šåœ¨è¾“å‡ºæœ€ååŠ ä¸Šä¸€ä¸ªæ ¼å¼åŒ–æ¢è¡Œç¬¦.&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;åˆ°æ­¤æˆ‘ä»¬çš„ &lt;code&gt;helloWord.go&lt;/code&gt; ä»£ç åˆ†æç»“æŸ&lt;br /&gt;&#xA;ä¸‹ä¸€ç¯‡åšæ–‡è®©æˆ‘çœŸæ­£çš„èµ°è¿›golang &lt;code&gt;&amp;lt;&amp;lt;goalngç¼–ç¨‹åŸºç¡€-åŸºæœ¬è¯­æ³•&amp;gt;&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2015/golang ç¼–ç¨‹åŸºç¡€ - Hello,Word.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>Markdownå†™ä½œè§„èŒƒå‚è€ƒ</title>
    <updated>2015-11-27T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2015-11-27:/2015/Markdownå†™ä½œè§„èŒƒå‚è€ƒ.html</id>
    <content type="html">&lt;p&gt;ä¹‹å‰è½¬å‘äº†GCçš„ä¸€ç¯‡ä»‹ç»markdownçš„å†™ä½œè¯­æ³•ä»¥åŠå¦‚ä½•åœ¨é¡µé¢é‡Œå¼•ç”¨markdownçš„æ–‡ç« ,å†™çš„å·²ç»å¾ˆå…¨é¢äº†,æˆ‘åœ¨æ­¤å°±ä¸åšå¤šä½™çš„ä»‹ç»äº†,æœ‰å…´è¶£å¯ä»¥è‡ªè¡ŒæŸ¥é˜…&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&#34;http://www.igouc.com/jsp/Journal/journal_each.jsp?id=12&#34;&gt;Markdown-å…¥é—¨æŒ‡å—åŠç½‘ç«™æ•´åˆ&lt;/a&gt; .å…¶å®æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„å†™ä½œè§„èŒƒ,åœ¨æ­¤æˆ‘åªæ˜¯ç®€å•çš„è¯´è¯´æˆ‘çš„markdownå†™ä½œè§„èŒƒ,ä»¥ä¾›å¤§å®¶å‚è€ƒ.&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;1. å¦‚ä½•ä½¿ç”¨åŠ ç²—&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;markdownæä¾›ä¸¤ç§æ–¹æ³•&#xA;&lt;code&gt;**åŠ ç²—**&lt;/code&gt; æˆ–æ˜¯ &lt;code&gt;__åŠ ç²—__&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä½†æ˜¯æˆ‘ä¸ªäººæ¨èä½¿ç”¨ &lt;code&gt;**åŠ ç²—**&lt;/code&gt;&#xA;&lt;a name=&#34;reason&#34;&gt;æ¨èç†ç”±&lt;/a&gt;:å–œæ¬¢å°±å¥½ï¼ˆä½†æ˜¯è¦ç»Ÿä¸€ç”¨æ³•ï¼Œæœ€å¥½åˆ«å†ä¸€ç¯‡æ–‡ç« é‡Œæ··ç”¨ï¼Œè¿™æ ·æ–‡ç« ä¼šæ˜¾å¾—å¾ˆä¹±ï¼Œä¸æ˜“äºä»¥åä¿®æ”¹)&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;2. å¦‚ä½•ä½¿ç”¨æ–œä½“ã€€ã€€&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;markdownæä¾›ä¸¤ç§æ–¹æ³•&#xA;&lt;code&gt;*åŠ æ–œ*&lt;/code&gt; æˆ–æ˜¯ &lt;code&gt;_åŠ æ–œ_&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä½†æ˜¯æˆ‘ä¸ªäººæ¨èä½¿ç”¨ &lt;code&gt;*åŠ æ–œ*&lt;/code&gt;&#xA;æ¨èç†ç”±:&lt;a href=&#34;#reason&#34;&gt;åŒä¸Š&lt;/a&gt;ï¼&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;3. å¦‚ä½•ä½¿ç”¨åŠ ç²—å¹¶æ–œä½“&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;åŠ ç²—å’Œæ–œä½“çš„ç»„åˆåº”è¯¥åˆå››ç§&#xA;&lt;code&gt;***åŠ ç²—å¹¶æ–œä½“***&lt;/code&gt;ã€&lt;code&gt;**_åŠ ç²—å¹¶æ–œä½“_**&lt;/code&gt;ã€&lt;code&gt;__*åŠ ç²—å¹¶æ–œä½“*__&lt;/code&gt;ã€&lt;code&gt;___åŠ ç²—å¹¶æ–œä½“___&lt;/code&gt;&#xA;å¦‚æœæˆ‘ä»¬åœ¨ä¸€ç¯‡æ–‡ç« é‡Œæ··ç”¨è¿™å››ç§,é‚£æˆ‘ä»¬åœ¨ä¿®æ”¹çš„æ—¶å€™å¯æƒ³è€ŒçŸ¥,å‘µå‘µ&amp;hellip;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸ªäººæ¨è:&lt;code&gt;***åŠ ç²—å¹¶æ–œä½“***&lt;/code&gt;&#xA;æ¨èç†ç”±:æ—¢ç„¶æˆ‘ä»¬å·²ç»é€‰æ‹©çš„å•åŠ ç²—ä»¥åŠå•æ–œä½“çš„ç”¨æ³•,é‚£æˆ‘ä»¬å°±ç»§ç»­ä»»æ€§åˆ°åº•å‘—&amp;hellip;.&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;4. å¦‚ä½•ä½¿ç”¨æ ‡é¢˜&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;h1 ä¸¤ç§æ–¹å¼&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# è¿™æ˜¯æ–‡ç« h1æ ‡é¢˜&#xA;è¿™ä¹Ÿæ˜¯æ–‡ç« h1æ ‡é¢˜&#xA;=========&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;h2ä¸¤ç§æ–¹å¼&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;## è¿™æ˜¯æ–‡ç« h2æ ‡é¢˜&#xA;è¿™æ˜¯æ–‡ç« h2æ ‡é¢˜&#xA;-------&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;h3&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;### h3&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;h4, h5, h6  &amp;hellip;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸ªäººæ¨è: å…¨éƒ¨éƒ½ç”¨ &lt;code&gt;#&lt;/code&gt; è¿™ä¸ªç³»åˆ—&#xA;æ¨èç†ç”±: å–œæ¬¢å°±å¥½ï¼ˆä½†æ˜¯è¦ç»Ÿä¸€ç”¨æ³•ï¼Œæœ€å¥½åˆ«å†ä¸€ç¯‡æ–‡ç« é‡Œæ··ç”¨ï¼Œè¿™æ ·æ–‡ç« ä¼šæ˜¾å¾—å¾ˆä¹±ï¼Œä¸æ˜“äºä»¥åä¿®æ”¹)&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;5. å¦‚ä½•ä½¿ç”¨è¿æ¥&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;markdown æä¾›ä¸¤ç§è¿æ¥æ–¹æ³•&#xA;    1. æ™®é€šè¿æ¥: &lt;code&gt;[æ˜¾ç¤ºæ–‡æœ¬](è¿æ¥åœ°å€)&lt;/code&gt;     å›¾åƒè¿æ¥: &lt;code&gt;![](å›¾åƒè¿æ¥åœ°å€)&lt;/code&gt;&#xA;    2. æ™®é€šè¿æ¥: &lt;code&gt;[æ˜¾ç¤ºæ–‡æœ¬][è¿æ¥æ ‡ç­¾]&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸ªäººæ¨è: æ®µè½å†…ä½¿ç”¨ &lt;code&gt;[æ˜¾ç¤ºæ–‡æœ¬][è¿æ¥æ ‡ç­¾]&lt;/code&gt; ,å·¦å³å„ç•™ä¸€ç©ºæ ¼,&#xA;ä¸æ¨èä½¿ç”¨ &lt;code&gt;[æ˜¾ç¤ºæ–‡æœ¬](è¿æ¥åœ°å€)&lt;/code&gt;&#xA;æ¨èç†ç”±: &lt;code&gt;[æ˜¾ç¤ºæ–‡æœ¬](è¿æ¥åœ°å€)&lt;/code&gt; å®¹æ˜“ä½¿æ®µè½çœ‹èµ·æ¥è‡ƒè‚¿ ,é™¤éä¸€äº›ç‰¹æ®Šæƒ…å†µ,å…·ä½“åˆ†æ.&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;6. è¿æ¥çš„URLæ”¾åœ¨å“ª?&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;æ¯”å¦‚ä½ æœ‰è¿™æ ·ä¸€ä¸ªæ®µè½ï¼š&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;è¿™æ˜¯ä¸€ä¸ªå¸¦æœ‰[è¶…é“¾æ¥][link-to]çš„æ®µè½ã€‚&lt;/code&gt;&#xA;ä½ çš„ [link-to]: url æ”¾åœ¨å“ªï¼Ÿç´§è·Ÿæ®µè½åé¢ï¼Œè¿˜æ˜¯ä¸€å¤§ç« èŠ‚åé¢ï¼Œè¿˜æ˜¯å…¨æ–‡æœ€åï¼Ÿ&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ä¸ªäººæ¨è: æ”¾åœ¨ç« èŠ‚åé¢,æ¯”å¦‚æ”¾åœ¨ä¸‹ä¸€ä¸ªå››çº§æ ‡é¢˜å‰&#xA;æ¨èç†ç”±: ä¸ªäººç»çš„å¥½åƒçœ‹èµ·æ¥æ›´çˆ½ä¸€ç‚¹,æ–‡æœ¬æ›´æ•´æ´ä¸€ç‚¹.&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;7. å¦‚ä½•ä½¿ç”¨ç©ºæ ¼ã€ç©ºè¡Œã€åˆ†éš”ç¬¦&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;ç©ºæ ¼: æ¨èåœ¨å„çº§æ ‡é¢˜ &lt;code&gt;###&lt;/code&gt; ä»¥åŠåˆ—è¡¨ &lt;code&gt;*&lt;/code&gt;ã€&lt;code&gt;+&lt;/code&gt;ã€ &lt;code&gt;-&lt;/code&gt;ã€ &lt;code&gt;1.&lt;/code&gt; çš„åè¾¹è·Ÿä¸€ç©ºæ ¼ ,ä¸­è‹±æ–‡ä¹‹é—´åŠ ç©ºæ ¼,æ­£æ–‡ä¸ä¸“æœ‰åè¯ä¹‹é—´ç•™ç©ºæ ¼&#xA;ç©ºè¡Œ: æ¨èåœ¨å„çº§æ ‡é¢˜ &lt;code&gt;###&lt;/code&gt; å‰å¤šç•™å‡ ä¸ªç©ºè¡Œ,&lt;code&gt;###&lt;/code&gt; åç•™ä¸€ç©ºè¡Œ&#xA;åˆ†éš”ç¬¦: åœ¨åº”è¯¥åˆ†å‰²çš„åœ°æ–¹ï¼ŒMarkdown æ”¯æŒç”¨ä¸€ä¸ªç©ºè¡ŒåŠ  &amp;mdash;ï¼ˆå¯ä»¥æ›´å¤šä¸ª-ï¼‰ å½¢æˆä¸€ä¸ª&lt;code&gt;&amp;lt;hr&amp;gt;&lt;/code&gt;ï¼ˆåˆ†å‰²ç¬¦ï¼‰&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ¨èç†ç”±: ä¸ªäººæ„Ÿè§‰æ›´æ•´æ´&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;8. æœ€åæ€»ç»“&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;å½¢æˆè‡ªå·±çš„Markdownå†™ä½œè§„èŒƒ, ä¸»è¦ä¿æŒã€è§„èŒƒã€ç»Ÿä¸€ã€æ•´æ´, ä¾¿äºä»¥åä¿®æ”¹.&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;è¿™ç¯‡æ–‡ç« ä»…ä»£è¡¨ä½œè€…ä¸ªäººè§‚ç‚¹,ä»…æä¾›å‚è€ƒ&#xA;å…¶å®æˆ‘çš„å†™ä½œè§„èŒƒå—è¿™ç¯‡æ–‡ç« çš„å½±å“ &lt;a href=&#34;http://www.jianshu.com/p/3bd994e702a7&#34;&gt;Markdown å†™ä½œè§„èŒƒå‚è€ƒ&lt;/a&gt; å‚è€ƒäº†å…¶éƒ¨åˆ†å†…å®¹ (ä¸æ˜¯æœ‰æ„å‚è€ƒå®åœ¨æ˜¯è¿™å·²å˜æˆäº†æˆ‘è‡ªå·±çš„å†™ä½œè§„èŒƒ)&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2015/Markdownå†™ä½œè§„èŒƒå‚è€ƒ.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
  <entry>
    <title>golangè‡ªå»ºHTTPæœåŠ¡å™¨</title>
    <updated>2015-11-20T00:00:00Z</updated>
    <id>tag:www.cwen.pw,2015-11-20:/2015/golangè‡ªå»ºHTTPæœåŠ¡å™¨.html</id>
    <content type="html">&lt;p&gt;golangä½œä¸ºäºŒåä¸€ä¸–çºªçš„ç¼–ç¨‹è¯­è¨€ï¼Œè®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹golangæ˜¯å¦‚ä½•å®ç°è‡ªå·±çš„httpæœåŠ¡å™¨&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;goå°è£…httpæœåŠ¡å™¨ç®€å•å®ä¾‹&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;è®©æˆ‘ä»¬ç›´æ¥æ¥çœ‹ä»£ç &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package main&#xA;import (&#xA;    &amp;quot;io&amp;quot;&#xA;    &amp;quot;net/http&amp;quot;&#xA;    &amp;quot;log&amp;quot;&#xA;)&#xA;// hello world, the web server&#xA;func HelloServer(w http.ResponseWriter, req *http.Request) {&#xA;    io.WriteString(w, &amp;quot;hello, world!\n&amp;quot;)&#xA;}&#xA;func main() {&#xA;    http.HandleFunc(&amp;quot;/hello&amp;quot;, HelloServer)&#xA;    err := http.ListenAndServe(&amp;quot;:12345&amp;quot;, nil)&#xA;    if err != nil {&#xA;        log.Fatal(&amp;quot;ListenAndServe: &amp;quot;, err)&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ²¡é”™å°±æ˜¯è¿™ä¹ˆç®€å•è¿,ä¸€ä¸ªhttpæœåŠ¡å™¨å°±æ­å»ºæˆåŠŸï¼Œåªè¦è°ƒç”¨httpåŒ…çš„ä¸¤ä¸ªå‡½æ•°å°±å¯ä»¥äº†ã€‚&#xA;è¿™é‡Œé¦–å…ˆè°ƒç”¨çš„æ˜¯&lt;code&gt;http.HandleFunc&lt;/code&gt;å‡½æ•°ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//HandleFuncæ³¨å†Œä¸€ä¸ªå¤„ç†å™¨å‡½æ•°handlerå’Œå¯¹åº”çš„æ¨¡å¼patternï¼ˆæ³¨å†Œåˆ°DefaultServeMuxï¼‰ã€‚&#xA;//ServeMuxçš„æ–‡æ¡£è§£é‡Šäº†æ¨¡å¼çš„åŒ¹é…æœºåˆ¶ã€‚&#xA;func HandleFunc(pattern string, handler func(ResponseWriter, *Request))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ¥ç€å°±æ˜¯è®¾ç½®ç›‘å¬ç«¯å£ï¼Œä½¿ç”¨çš„æ˜¯&lt;code&gt;http.ListenAndServer&lt;/code&gt;ã€‚å‡½æ•°ç­¾åå¦‚ä¸‹&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//ListenAndServeç›‘å¬TCPåœ°å€addrï¼Œå¹¶ä¸”ä¼šä½¿ç”¨handlerå‚æ•°è°ƒç”¨Serveå‡½æ•°å¤„ç†æ¥æ”¶åˆ°çš„è¿æ¥ã€‚&#xA;//handlerå‚æ•°ä¸€èˆ¬ä¼šè®¾ä¸ºnilï¼Œæ­¤æ—¶ä¼šä½¿ç”¨DefaultServeMuxã€‚&#xA;func ListenAndServe(addr string, handler Handler) error&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;çœ‹åˆ°è¿™é‡Œæˆ‘ç›¸ä¿¡å¤§å®¶è„‘å­é‡Œä¼šæœ‰å¾ˆå¤šç–‘æƒ‘&amp;hellip;é‚£ä¹ˆæˆ‘ä»¬å°±æ¥ç€å¾€ä¸‹æ¢è®¨&#xA;æˆ‘ä»¬å…ˆä»&lt;code&gt;ListenAndServe&lt;/code&gt;è¿™ä¸ªå‡½æ•°çœ‹èµ·ï¼Œçœ‹çœ‹å®ƒåˆ°åº•ä¸ºæˆ‘ä»¬åšäº†ä»€ä¹ˆ&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;ListenAndServeræ·±å…¥æ¢ç©¶&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬å…ˆä»æºç çœ‹èµ·&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;func ListenAndServe(addr string, handler Handler) error {&#xA;     server := &amp;amp;Server{Addr: addr, Handler: handler}&#xA;     return server.ListenAndServe()&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ä»å‡½æ•°çš„å‚æ•°æ¥çœ‹ï¼Œè¿™ä¸ªå‡½æ•°ä¼ å…¥ä¿©ä¸ªå‚æ•°ï¼Œ&lt;code&gt;addr&lt;/code&gt;å’Œ&lt;code&gt;handler&lt;/code&gt;ï¼Œå¾ˆæ˜æ˜¾&lt;code&gt;addr&lt;/code&gt;æ˜¯æˆ‘ä»¬æƒ³è¦ç›‘å¬çš„ç«¯å£åœ°å€,ç¬¬äºŒçš„å‚æ•°æ˜¯ä¸€ä¸ª&lt;a href=&#34;https://godoc.org/net/http#Handler&#34; title=&#34;Handler&#34;&gt;Handler&lt;/a&gt;,é€šè¿‡æŸ¥çœ‹æ–‡æ¡£å¾—çŸ¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªåªåŒ…å«äº†&lt;code&gt;ServeHTTP(ResponseWriter, *Request)&lt;/code&gt;çš„æ¥å£ï¼Œä¹Ÿå°±è¯´åªè¦æŸä¸ª&lt;code&gt;struct&lt;/code&gt;æœ‰`&lt;code&gt;ServeHTTP(ResponseWriter, *Request)&lt;/code&gt;è¿™ä¸ªæ–¹æ³•ï¼Œé‚£è¿™ä¸ª&lt;code&gt;struct&lt;/code&gt;å°±è‡ªåŠ¨å®ç°äº†&lt;code&gt;Handler&lt;/code&gt;æ¥å£ã€‚&#xA;æ˜¾ç¤ºä»€ä¹ˆç½‘é¡µå–å†³äºç¬¬äºŒä¸ªå‚æ•°&lt;code&gt;Hander&lt;/code&gt;ï¼Œ&lt;code&gt;Hander&lt;/code&gt;åˆåªæœ‰1ä¸ª&lt;code&gt;ServeHTTP&lt;/code&gt;&#xA;æ‰€ä»¥å¯ä»¥è¯æ˜ï¼Œæ˜¾ç¤ºä»€ä¹ˆç½‘é¡µå–å†³äºServeHTTP&#xA;é‚£å°±&lt;code&gt;ServeHTTP&lt;/code&gt;æ–¹æ³•ï¼Œä»–éœ€è¦2ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯&lt;code&gt;http.ResponseWriter&lt;/code&gt;ï¼Œå¦ä¸€ä¸ªæ˜¯&lt;code&gt;http.Request&lt;/code&gt;&#xA;å¾€&lt;code&gt;http.ResponseWriter&lt;/code&gt;å†™å…¥ä»€ä¹ˆå†…å®¹ï¼Œæµè§ˆå™¨çš„ç½‘é¡µæºç å°±æ˜¯ä»€ä¹ˆå†…å®¹&#xA;http.Requesté‡Œé¢æ˜¯å°è£…äº†ï¼Œæµè§ˆå™¨å‘è¿‡æ¥çš„è¯·æ±‚ï¼ˆåŒ…å«è·¯å¾„ã€æµè§ˆå™¨ç±»å‹ç­‰ç­‰ï¼‰&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æ¥ä¸‹æ¥è®©æˆ‘æ¥å®ç°ä¸€ä¸ªè‡ªå·±&lt;code&gt;Handler&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package main&#xA;&#xA;import (&#xA;    &amp;quot;io&amp;quot;&#xA;    &amp;quot;log&amp;quot;&#xA;    &amp;quot;net/http&amp;quot;&#xA;)&#xA;&#xA;type myHandler struct{}&#xA;&#xA;func (*myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {&#xA;    io.WriteString(w, &amp;quot;myHandler Hello Word&amp;quot;)&#xA;}&#xA;&#xA;func main() {&#xA;&#xA;    err := http.ListenAndServe(&amp;quot;:12345&amp;quot;, &amp;amp;myHandler{})&#xA;    if err != nil {&#xA;        log.Fatal(&amp;quot;ListenAndServe: &amp;quot;, err)&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å½“&lt;code&gt;http.ListenAndServe(&amp;quot;:12345&amp;quot;, &amp;amp;myHandler{})&lt;/code&gt;åï¼Œå¼€å§‹ç­‰å¾…æœ‰è®¿é—®è¯·æ±‚&#xA;ä¸€æ—¦æœ‰è®¿é—®è¯·æ±‚è¿‡æ¥ï¼ŒhttpåŒ…å¸®æˆ‘ä»¬å¤„ç†äº†ä¸€ç³»åˆ—åŠ¨ä½œåï¼Œæœ€åä»–ä¼šå»è°ƒç”¨&lt;code&gt;myHandler&lt;/code&gt;çš„&lt;code&gt;ServeHTTP&lt;/code&gt;è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶æŠŠè‡ªå·±å·²ç»å¤„ç†å¥½çš„&lt;code&gt;http.ResponseWriter&lt;/code&gt;, &lt;code&gt;*http.Request&lt;/code&gt;ä¼ è¿›å»&#xA;è€Œ&lt;code&gt;myHandler&lt;/code&gt;çš„&lt;code&gt;ServeHTTP&lt;/code&gt;è¿™ä¸ªæ–¹æ³•ï¼Œæ‹¿åˆ°&lt;code&gt;*http.ResponseWriter&lt;/code&gt;åï¼Œå¹¶å¾€é‡Œé¢å†™ä¸œè¥¿ï¼Œå®¢æˆ·ç«¯çš„ç½‘é¡µå°±æ˜¾ç¤ºå‡ºæ¥äº†&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æˆ‘æ¥ç€è¿˜æ˜¯å›åˆ°&lt;code&gt;ListenAndServe&lt;/code&gt;è¿™ä¸ªå‡½æ•°ä¸Šï¼Œçœ‹çœ‹è¿™ä¸ªå‡½æ•°åˆ°åº•ä¸ºæˆ‘ä»¬å¹²äº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ&#xA;è¿™ä¸ªåº•å±‚å…¶å®è¿™æ ·å¤„ç†çš„ï¼šåˆå§‹åŒ–ä¸€ä¸ª&lt;code&gt;server&lt;/code&gt;å¯¹è±¡ï¼Œç„¶åè°ƒç”¨äº†&lt;code&gt;server.ListenAndServe()&lt;/code&gt;&#xA;æˆ‘ä»¬è·³åˆ°&lt;code&gt;server.ListenAndServe()&lt;/code&gt; å¤„&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// ListenAndServe listens on the TCP network address srv.Addr and then&#xA;// calls Serve to handle requests on incoming connections.  If&#xA;// srv.Addr is blank, &amp;quot;:http&amp;quot; is used.&#xA; func (srv *Server) ListenAndServe() error {&#xA;    addr := srv.Addr&#xA;    if addr == &amp;quot;&amp;quot; {&#xA;        addr = &amp;quot;:http&amp;quot;&#xA;    }&#xA;    ln, err := net.Listen(&amp;quot;tcp&amp;quot;, addr)&#xA;    if err != nil {&#xA;        return err&#xA;    }&#xA;    return srv.Serve(tcpKeepAliveListener{ln.(*net.TCPListener)})&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å¯ä»¥çœ‹åˆ°å…¶å®&lt;code&gt;server.ListenAndServe()&lt;/code&gt;åªæ˜¯è°ƒç”¨äº†&lt;code&gt;net.Listen(&amp;quot;tcp&amp;quot;, addr)&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯åº•å±‚ç”¨TCPåè®®æ­å»ºäº†ä¸€ä¸ªæœåŠ¡ï¼Œç„¶åç›‘æ§æˆ‘ä»¬è®¾ç½®çš„ç«¯å£ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬åœ¨çœ‹çœ‹&lt;code&gt;Serve&lt;/code&gt;å‡½æ•°ï¼Œ&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// Serve accepts incoming connections on the Listener l, creating a&#xA;// new service goroutine for each.  The service goroutines read requests and&#xA;// then call srv.Handler to reply to them.&#xA;func (srv *Server) Serve(l net.Listener) error {&#xA;    defer l.Close()&#xA;    var tempDelay time.Duration // how long to sleep on accept failure&#xA;    for {&#xA;        rw, e := l.Accept()&#xA;        if e != nil {&#xA;            if ne, ok := e.(net.Error); ok &amp;amp;&amp;amp; ne.Temporary() {&#xA;                if tempDelay == 0 {&#xA;                    tempDelay = 5 * time.Millisecond&#xA;                } else {&#xA;                    tempDelay *= 2&#xA;                }&#xA;                if max := 1 * time.Second; tempDelay &amp;gt; max {&#xA;                    tempDelay = max&#xA;                }&#xA;                srv.logf(&amp;quot;http: Accept error: %v; retrying in %v&amp;quot;, e, tempDelay)&#xA;                time.Sleep(tempDelay)&#xA;                continue&#xA;            }&#xA;            return e&#xA;        }&#xA;        tempDelay = 0&#xA;        c, err := srv.newConn(rw)&#xA;        if err != nil {&#xA;            continue&#xA;        }&#xA;        c.setState(c.rwc, StateNew) // before Serve can return&#xA;        go c.serve()&#xA;    }&#xA;}&#xA;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ç›‘æ§ä¹‹åå¦‚ä½•æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚å‘¢ï¼Ÿä¸Šé¢ä»£ç æ‰§è¡Œç›‘æ§ç«¯å£ä¹‹åï¼Œè°ƒç”¨äº†&lt;code&gt;srv.Serve(net.Listener)&lt;/code&gt;å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯å¤„ç†æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ä¿¡æ¯ã€‚è¿™ä¸ªå‡½æ•°é‡Œé¢èµ·äº†ä¸€ä¸ª&lt;code&gt;for{}&lt;/code&gt;ï¼Œé¦–å…ˆé€šè¿‡&lt;code&gt;Listener&lt;/code&gt;æ¥æ”¶è¯·æ±‚ï¼Œå…¶æ¬¡åˆ›å»ºä¸€ä¸ª&lt;code&gt;Conn&lt;/code&gt;ï¼Œæœ€åå•ç‹¬å¼€äº†ä¸€ä¸ª&lt;code&gt;goroutine&lt;/code&gt;ï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚çš„æ•°æ®å½“åšå‚æ•°æ‰”ç»™è¿™ä¸ª&lt;code&gt;conn&lt;/code&gt;å»æœåŠ¡ï¼š&lt;code&gt;go c.serve()&lt;/code&gt;ã€‚è¿™ä¸ªå°±æ˜¯é«˜å¹¶å‘ä½“ç°äº†ï¼Œç”¨æˆ·çš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯åœ¨ä¸€ä¸ªæ–°çš„&lt;code&gt;goroutine&lt;/code&gt;å»æœåŠ¡ï¼Œç›¸äº’ä¸å½±å“ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;é‚£ä¹ˆå¦‚ä½•å…·ä½“åˆ†é…åˆ°ç›¸åº”çš„å‡½æ•°æ¥å¤„ç†è¯·æ±‚å‘¢ï¼Ÿ&lt;code&gt;conn&lt;/code&gt;é¦–å…ˆä¼šè§£æ&lt;code&gt;request:c.readRequest()&lt;/code&gt;,ç„¶åè·å–ç›¸åº”çš„&lt;code&gt;handler:handler := c.server.Handler&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰åœ¨è°ƒç”¨å‡½æ•°&lt;code&gt;ListenAndServe&lt;/code&gt;æ—¶å€™çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å‰é¢ä¾‹å­ä¼ é€’çš„æ˜¯&lt;code&gt;nil&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯ä¸ºç©ºï¼Œé‚£ä¹ˆé»˜è®¤è·å–&lt;code&gt;handler = DefaultServeMux&lt;/code&gt;,é‚£ä¹ˆè¿™ä¸ªå˜é‡ç”¨æ¥åšä»€ä¹ˆçš„å‘¢ï¼Ÿå¯¹ï¼Œè¿™ä¸ªå˜é‡å°±æ˜¯ä¸€ä¸ªè·¯ç”±å™¨ï¼Œå®ƒç”¨æ¥åŒ¹é…urlè·³è½¬åˆ°å…¶ç›¸åº”çš„&lt;code&gt;handle&lt;/code&gt;å‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆ‘ä»¬æœ‰è®¾ç½®è¿‡å—?æœ‰ï¼Œæˆ‘ä»¬è°ƒç”¨çš„ä»£ç é‡Œé¢ç¬¬ä¸€å¥ä¸æ˜¯è°ƒç”¨äº†&lt;code&gt;http.HandleFunc(&amp;quot;/&amp;quot;, HelloServer)&lt;/code&gt;å˜›ã€‚è¿™ä¸ªä½œç”¨å°±æ˜¯æ³¨å†Œäº†è¯·æ±‚/çš„è·¯ç”±è§„åˆ™ï¼Œå½“è¯·æ±‚&lt;code&gt;uri&lt;/code&gt;ä¸º&lt;code&gt;&amp;quot;/&amp;quot;&lt;/code&gt;ï¼Œè·¯ç”±å°±ä¼šè½¬åˆ°å‡½æ•°&lt;code&gt;HelloServer&lt;/code&gt;ï¼Œ&lt;code&gt;DefaultServeMux&lt;/code&gt;ä¼šè°ƒç”¨&lt;code&gt;ServeHTTP&lt;/code&gt;æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å†…éƒ¨å…¶å®å°±æ˜¯è°ƒç”¨&lt;code&gt;HelloServer&lt;/code&gt;æœ¬èº«ï¼Œæœ€åé€šè¿‡å†™å…¥&lt;code&gt;response&lt;/code&gt;çš„ä¿¡æ¯åé¦ˆåˆ°å®¢æˆ·ç«¯ã€‚&#xA;&lt;img src=&#34;http://7xnp02.com1.z0.glb.clouddn.com/3.3.illustrator.png&#34; alt=&#34;&#34; /&gt;&#xA;&lt;strong&gt;httpè¿æ¥å¤„ç†æµç¨‹(å›¾ç‰‡æ‘˜è‡ª&lt;a href=&#34;https://github.com/astaxie/build-web-application-with-golang&#34;&gt;go webç¼–ç¨‹&lt;/a&gt;)&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;h4&gt;è·¯ç”±å¤„ç†&lt;/h4&gt;&#xA;&#xA;&lt;p&gt;å®é™…ä¸Šæˆ‘ä»¬åœ¨å‰è¾¹ä¹Ÿå¤šå¤šå°‘å°‘è°ˆåˆ°äº†è·¯ç”±ï¼Œå‰é¢æœ‰è¯´åˆ°å®ç°&lt;code&gt;Handler&lt;/code&gt;æ¥å£çš„&lt;code&gt;struct&lt;/code&gt;,æ²¡é”™æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ª&lt;code&gt;struct&lt;/code&gt;çš„&lt;code&gt;ServeHTTP&lt;/code&gt;å‡½æ•°ä¸­è¿›è¡Œè·¯ç”±åˆ¤æ–­&#xA;æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package main&#xA;&#xA;import (&#xA;    &amp;quot;io&amp;quot;&#xA;    &amp;quot;log&amp;quot;&#xA;    &amp;quot;net/http&amp;quot;&#xA;)&#xA;&#xA;type myHandler struct{}&#xA;&#xA;func (*myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {&#xA;    path := r.URL.String()&#xA;    switch path {&#xA;    case &amp;quot;/&amp;quot;:&#xA;        io.WriteString(w, &amp;quot;&amp;lt;h1&amp;gt;root&amp;lt;/h1&amp;gt;&amp;lt;a href=\&amp;quot;abc\&amp;quot;&amp;gt;abc&amp;lt;/a&amp;gt;&amp;quot;)&#xA;    case &amp;quot;/abc&amp;quot;:&#xA;        io.WriteString(w, &amp;quot;&amp;lt;h1&amp;gt;abc&amp;lt;/h1&amp;gt;&amp;lt;a href=\&amp;quot;/\&amp;quot;&amp;gt;root&amp;lt;/a&amp;gt;&amp;quot;)&#xA;    }&#xA;}&#xA;&#xA;func main() {&#xA;&#xA;    err := http.ListenAndServe(&amp;quot;:12345&amp;quot;, &amp;amp;myHandler{})&#xA;    if err != nil {&#xA;        log.Fatal(&amp;quot;ListenAndServe: &amp;quot;, err)&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ²¡é”™æ¯ä¸€ä¸ª&lt;code&gt;case&lt;/code&gt;å°±æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†å¦‚æœä¸€ä¸ªç½‘ç«™æœ‰ä¸Šç™¾ä¸ªé¡µé¢ï¼Œè‚¿ä¹ˆåŠï¼Ÿä¸Šç™¾ä¸ª&lt;code&gt;case&lt;/code&gt;ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„(å…¶å®ä¸Šç™¾ä¸ª&lt;code&gt;case&lt;/code&gt;æ˜¯å¯ä»¥å®ç°)ã€‚é‚£æˆ‘ä»¬è¯¥è‚¿ä¹ˆåšå‘¢ï¼Ÿ&lt;/p&gt;&#xA;&#xA;&lt;p&gt;é‚£æ¥ä¸‹æ¥çœ‹çœ‹&lt;code&gt;ServeMux&lt;/code&gt;å§&amp;hellip;.&#xA;å…¶å®&lt;code&gt;ServeMax&lt;/code&gt;å­˜åœ¨ä¸€å¼ &lt;code&gt;map&lt;/code&gt;è¡¨ï¼Œ&lt;code&gt;map&lt;/code&gt;é‡Œçš„&lt;code&gt;key&lt;/code&gt;è®°å½•çš„æ˜¯&lt;code&gt;r.URL.String()&lt;/code&gt;ï¼Œè€Œ&lt;code&gt;value&lt;/code&gt;è®°å½•çš„æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å’Œ&lt;code&gt;ServeHTTP&lt;/code&gt;æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªåˆ«åï¼Œå«&lt;code&gt;HandlerFunc&lt;/code&gt;&#xA;&lt;code&gt;ServeMux&lt;/code&gt;è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•åå­—æ˜¯&lt;code&gt;Handle&lt;/code&gt;ï¼Œä»–æ˜¯ç”¨æ¥æ³¨å†Œ&lt;code&gt;HandlerFunc&lt;/code&gt; çš„&#xA;&lt;code&gt;ServeMux&lt;/code&gt;è¿˜æœ‰å¦ä¸€ä¸ªæ–¹æ³•åå­—æ˜¯&lt;code&gt;ServeHTTP&lt;/code&gt;ï¼Œè¿™æ ·&lt;code&gt;ServeMux&lt;/code&gt;æ˜¯å®ç°&lt;code&gt;Handler&lt;/code&gt;æ¥å£çš„ï¼Œå¦è€…æ— æ³•å½“&lt;code&gt;http.ListenAndServe&lt;/code&gt;çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ è¾“&#xA;æˆ‘ä»¬ç›´æ¥ä¸Šæºç &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;type ServeMux struct {&#xA;    mu sync.RWMutex   //é”ï¼Œç”±äºè¯·æ±‚æ¶‰åŠåˆ°å¹¶å‘å¤„ç†ï¼Œå› æ­¤è¿™é‡Œéœ€è¦ä¸€ä¸ªé”æœºåˆ¶&#xA;    m  map[string]muxEntry  //è·¯ç”±è§„åˆ™ï¼Œä¸€ä¸ªstringå¯¹åº”ä¸€ä¸ªmuxå®ä½“ï¼Œè¿™é‡Œçš„stringå°±æ˜¯æ³¨å†Œçš„è·¯ç”±è¡¨è¾¾å¼&#xA;    hosts bool // æ˜¯å¦åœ¨ä»»æ„çš„è§„åˆ™ä¸­å¸¦æœ‰hostä¿¡æ¯&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;å†çœ‹ &lt;code&gt;muxEntry&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;type muxEntry struct {&#xA;    explicit bool   // æ˜¯å¦ç²¾ç¡®åŒ¹é…&#xA;    h        Handler // è¿™ä¸ªè·¯ç”±è¡¨è¾¾å¼å¯¹åº”å“ªä¸ªhandler&#xA;    pattern  string  //åŒ¹é…å­—ç¬¦ä¸²&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ä½ æ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªç–‘é—®ï¼Ÿé‚£å°±æ˜¯æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™ç”¨ServeMaxï¼Ÿæ¥ä¸‹æ¥æˆ‘å°±ä¸ºä½ è§£ç­”è¿™å’Œé—®é¢˜&#xA;å…¶å®å½“æˆ‘ä»¬åœ¨è°ƒç”¨&lt;code&gt;http.ListenAndServe(&amp;quot;:12345&amp;quot;, nil)&lt;/code&gt;çš„æ—¶å€™ï¼Œç¬¬2ä¸ªå‚æ•°æ˜¯nilæ—¶&#xA;&lt;code&gt;http&lt;/code&gt;å†…éƒ¨ä¼šè‡ªå·±å»ºç«‹ä¸€ä¸ªå«&lt;code&gt;DefaultServeMux&lt;/code&gt;çš„&lt;code&gt;ServeMux&lt;/code&gt;ï¼Œå› ä¸ºè¿™ä¸ª&lt;code&gt;ServeMux&lt;/code&gt;æ˜¯&lt;code&gt;http&lt;/code&gt;è‡ªå·±ç»´æŠ¤çš„ï¼Œå¦‚æœè¦å‘è¿™ä¸ª&lt;code&gt;ServeMux&lt;/code&gt;æ³¨å†Œçš„è¯ï¼Œå°±è¦ç”¨http.HandleFuncè¿™ä¸ªæ–¹æ³•&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ç°åœ¨æˆ‘ä»¬åœ¨çœ‹æœ€ä¸€å¼€å§‹çš„&lt;code&gt;http.HandleFunc(&amp;quot;/hello&amp;quot;, HelloServer)&lt;/code&gt; å°±ä¼šé—®&lt;code&gt;HelloServer&lt;/code&gt; ä¸æ˜¯æ²¡æœ‰å®ç°&lt;code&gt;Handler&lt;/code&gt;æ¥å£å—ï¼Ÿ(å…¶å®è¿™ä¸ªåœ°æ–¹æˆ‘ä¹Ÿçº ç»“äº†å¥½ä¹…ï¼Œåæ¥æ‰¾äº†æºç ä»¥åŠçœ‹äº†å¥½å‡ ç¯‡å¤§ç‰›çš„åšå®¢æ‰æ˜ç™½è¿‡æ¥)&#xA;å…¶å®åœ¨httpä¸­å­˜åœ¨è¿™æ ·ä¸€ä¸ªç±»å‹&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;type HandlerFunc func(ResponseWriter, *Request)&#xA;&#xA;// ServeHTTP calls f(w, r).&#xA;func (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {&#xA;    f(w, r)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;æ²¡é”™å®ƒç»è¿‡ä¸€æ¬¡ç±»å‹è½¬æ¢ï¼Œå³æˆ‘ä»¬è°ƒç”¨äº†&lt;code&gt;HandlerFunc(f)&lt;/code&gt;,å¼ºåˆ¶ç±»å‹è½¬æ¢fæˆä¸º&lt;code&gt;HandlerFunc&lt;/code&gt;ç±»å‹ï¼Œè¿™æ ·få°±æ‹¥æœ‰äº†&lt;code&gt;ServeHTTP&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;&#xA;&#xA;&lt;p&gt;æˆ‘ä»¬ç°åœ¨ä¸ä½¿ç”¨&lt;code&gt;DefaultServeMux&lt;/code&gt;ï¼Œæ¥è‡ªå·±å®ç°ä¸€ä¸ª&lt;code&gt;ServeMax&lt;/code&gt;ï¼Œç›´æ¥ä¸Šä»£ç &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package main&#xA;&#xA;import (&#xA;    &amp;quot;io&amp;quot;&#xA;    &amp;quot;log&amp;quot;&#xA;    &amp;quot;net/http&amp;quot;&#xA;)&#xA;&#xA;type myHandler struct{}&#xA;&#xA;func (*myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {&#xA;    io.WriteString(w, &amp;quot;My server: &amp;quot;+r.URL.String())&#xA;}&#xA;&#xA;func sayBye(w http.ResponseWriter, r *http.Request) {&#xA;    io.WriteString(w, &amp;quot;Bye bye, this is version 2.&amp;quot;)&#xA;}&#xA;&#xA;func main() {&#xA;    mux := http.NewServeMux()&#xA;&#xA;    mux.Handle(&amp;quot;/&amp;quot;, &amp;amp;myHandler{})&#xA;&#xA;    // ä½¿ç”¨å‡½æ•°ä½œä¸º handler&#xA;    mux.HandleFunc(&amp;quot;/bye&amp;quot;, sayBye)&#xA;&#xA;    err = http.ListenAndServe(&amp;quot;:12345&amp;quot;, mux)&#xA;    if err != nil {&#xA;         log.Fatal(&amp;quot;ListenAndServe: &amp;quot;, err)&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;åˆ°è¿™é‡Œæˆ‘ä»¬çš„golangç‰ˆçš„httpæœåŠ¡å™¨å°±æ¢ç©¶ç»“æŸäº†ï¼Œå¦‚æœè¯»è€…æœ‰å…´è¶£è¿˜å¯ä»¥æ›´æ·±å…¥çš„æ¢ç©¶ï¼Œå°è¯•å®ç°è‡ªå·±çš„&lt;code&gt;Server&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;åšæ–‡å‚è€ƒäº† astaè°¢çš„&lt;a href=&#34;https://github.com/astaxie/build-web-application-with-golang&#34;&gt;ã€Šgo webç¼–ç¨‹ã€‹&lt;/a&gt;  ä»¥åŠ waynehu çš„ &lt;a href=&#34;http://my.oschina.net/u/943306/blog/151293&#34;&gt;goè¯­è¨€çš„httpåŒ…&lt;/a&gt; çš„è¿™ç¯‡åšå®¢ï¼Œåœ¨æ­¤æ„Ÿè°¢è¿™ä¸¤ä½ä½œè€…&#xA;å¦‚æœ‰å‘ç°ä»€ä¸æ­£ç¡®æˆ–æ˜¯æœ‰ç–‘é—®çš„åœ°æ–¹ï¼Œæ¬¢è¿ç•™è¨€æˆ–æ˜¯å‘é‚®ä»¶è”ç³»åšä¸»&#xA;å¦‚æœ‰è½¬è½½è¯·æ³¨æ˜å‡ºå¤„&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;</content>
    <link href="http://www.cwen.pw/2015/golangè‡ªå»ºHTTPæœåŠ¡å™¨.html"></link>
    <author>
      <name>cwen</name>
    </author>
  </entry>
</feed>